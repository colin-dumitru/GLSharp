// Engine.js
(function(){
Type.registerNamespace('GLSharp.Content');GLSharp.Content.IResourceConverter=function(){};GLSharp.Content.IResourceConverter.registerInterface('GLSharp.Content.IResourceConverter');GLSharp.Content.LightItem=function(){}
GLSharp.Content.LightItem.prototype={$0:null,get_id:function(){return this.$0;},set_id:function(value){this.$0=value;return value;},$1:0,get_type:function(){return this.$1;},set_type:function(value){this.$1=value;return value;},$2:null,get_properties:function(){return this.$2;},set_properties:function(value){this.$2=value;return value;}}
GLSharp.Content.LightConverter=function(){}
GLSharp.Content.LightConverter.prototype={get_typeHandled:function(){return 'light';},convert:function(input){var $0=input;var $1=new GLSharp.Content.LightItem();$1.set_id($0.Id);$1.set_type($0.Type);$1.set_properties({});var $dict1=$0.Properties;for(var $key2 in $dict1){var $2={key:$key2,value:$dict1[$key2]};if($2.key==='color'){var $3=$2.value.split(' ');var $4=GLSharp.Core.SystemCore.get_environment().createFloat32Array($3.length);for(var $5=0;$5<$3.length;$5++){$4[$5]=parseFloat($3[$5]);}$1.get_properties()['color']=$4;}else if($2.key==='intensity'){$1.get_properties()['intensity']=parseFloat($2.value);}else if($2.key==='falloff_angle'){$1.get_properties()['falloff_angle']=parseFloat($2.value);}}return $1;}}
GLSharp.Content.MeshItem=function(){}
GLSharp.Content.MeshItem.prototype={$0:null,get_id:function(){return this.$0;},set_id:function(value){this.$0=value;return value;},$1:null,get_indexes:function(){return this.$1;},set_indexes:function(value){this.$1=value;return value;},$2:null,get_normals:function(){return this.$2;},set_normals:function(value){this.$2=value;return value;},$3:null,get_uVs:function(){return this.$3;},set_uVs:function(value){this.$3=value;return value;},$4:null,get_vertices:function(){return this.$4;},set_vertices:function(value){this.$4=value;return value;}}
GLSharp.Content.MeshConverter=function(){}
GLSharp.Content.MeshConverter.prototype={get_typeHandled:function(){return 'mesh';},convert:function(input){if(input==null){return null;}var $0=input;var $1=new GLSharp.Content.MeshItem();$1.set_id($0.Id);$1.set_indexes(GLSharp.Core.SystemCore.get_environment().createInt32ArrayFromArray($0.Indexes));$1.set_normals(GLSharp.Core.SystemCore.get_environment().createFloat32ArrayFromArray($0.Normals));$1.set_uVs(GLSharp.Core.SystemCore.get_environment().createFloat32ArrayFromArray($0.UVs));$1.set_vertices(GLSharp.Core.SystemCore.get_environment().createFloat32ArrayFromArray($0.Vertices));return $1;}}
GLSharp.Content.NodeConverter=function(){}
GLSharp.Content.NodeConverter.prototype={get_typeHandled:function(){return 'node';},convert:function(input){var $0=input;return this.$0($0);},$0:function($p0){var $0=new GLSharp.Universe.Node();$0.set_id($p0.Id);$0.set_matrix(new GLSharp.Util.Matrix4X4($p0.Matrix));if($p0.Children!=null){var $enum1=ss.IEnumerator.getEnumerator($p0.Children);while($enum1.moveNext()){var $2=$enum1.current;$0.addChild(this.$0($2));}}var $1=[];var $enum2=ss.IEnumerator.getEnumerator($p0.References);while($enum2.moveNext()){var $3=$enum2.current;this.$1($3,$1);}var $enum3=ss.IEnumerator.getEnumerator($1);while($enum3.moveNext()){var $4=$enum3.current;$0.addComponent($4);}return $0;},$1:function($p0,$p1){if($p0.Type==='mesh'){var $0=new GLSharp.Universe.MeshComponent();var $1=new GLSharp.Content.Handle();$1.set_library($p0.Library);$1.set_id($p0.Resource);$0.set_meshHandle($1);$p1.add($0);}else if($p0.Type==='material'){var $2=new GLSharp.Universe.MaterialComponent();var $3=new GLSharp.Content.Handle();$3.set_library($p0.Library);$3.set_id($p0.Resource);$2.set_materialHandle($3);$p1.add($2);}if($p0.Children!=null){var $enum1=ss.IEnumerator.getEnumerator($p0.Children);while($enum1.moveNext()){var $4=$enum1.current;this.$1($4,$p1);}}}}
GLSharp.Content.Handle=function(){}
GLSharp.Content.Handle.prototype={$0:null,get_library:function(){return this.$0;},set_library:function(value){this.$0=value;return value;},$1:null,get_id:function(){return this.$1;},set_id:function(value){this.$1=value;return value;}}
GLSharp.Content.Collection=function(){}
GLSharp.Content.Collection.prototype={$0:null,get_name:function(){return this.$0;},set_name:function(value){this.$0=value;return value;},$1:null,get_resources:function(){return this.$1;},set_resources:function(value){this.$1=value;return value;}}
GLSharp.Content.ResourceItem=function(){}
GLSharp.Content.ResourceItem.prototype={$0:null,get_id:function(){return this.$0;},set_id:function(value){this.$0=value;return value;},$1:null,get_type:function(){return this.$1;},set_type:function(value){this.$1=value;return value;},$2:null,get_item:function(){return this.$2;},set_item:function(value){this.$2=value;return value;}}
GLSharp.Content.Library=function(){this.$0={};this.$1={};}
GLSharp.Content.Library.prototype={$0:null,$1:null,add_collectionLoaded:function(value){this.$2=ss.Delegate.combine(this.$2,value);},remove_collectionLoaded:function(value){this.$2=ss.Delegate.remove(this.$2,value);},$2:null,loadLibrary:function(url){var $0=new GLSharp.Data.ResourceManagerParams();$0.set_type('json');GLSharp.Core.SystemCore.get_resourceManager().getResource(url,$0).add_resourceChanged(ss.Delegate.create(this,function($p1_0,$p1_1){
if($p1_0.get_finished()){this.$3($p1_0.get_data());}}));},$3:function($p0){var $0=$p0;GLSharp.Core.SystemCore.get_logger().log('Loading library : '+$0.Name);var $1=null;if(($1=this.$0[$0.Name])==null){$1=new GLSharp.Content.Collection();$1.set_name($0.Name);$1.set_resources({});this.$0[$1.get_name()]=$1;}this.$4($1,$0.ContentObjects);if(this.$2!=null){this.$2(this,$1);}},$4:function($p0,$p1){var $enum1=ss.IEnumerator.getEnumerator($p1);while($enum1.moveNext()){var $0=$enum1.current;var $1=this.$1[$0.Type];if($1==null){GLSharp.Core.SystemCore.get_logger().log('No resource converter found for resource + '+$0.Resource);continue;}var $2=$1.convert($0.Resource);var $3=new GLSharp.Content.ResourceItem();$3.set_id($0.Id);$3.set_type($0.Type);$3.set_item($2);$p0.get_resources()[$3.get_id()]=$3;}},unloadLibrary:function(name){},findResource:function(library,resourceName){var $0=null;if(($0=this.$0[library])==null){return null;}var $1=null;if(($1=$0.get_resources()[resourceName])==null){return null;}var $2=new GLSharp.Content.Handle();$2.set_library(library);$2.set_id(resourceName);return $2;},getResource:function(handle){return this.$0[handle.get_library()].get_resources()[handle.get_id()];},addConverter:function(converter){this.$1[converter.get_typeHandled()]=converter;},removeConverter:function(converter){delete this.$1[converter.get_typeHandled()];}}
Type.registerNamespace('GLSharp.Universe');GLSharp.Universe.MaterialComponent=function(){GLSharp.Universe.MaterialComponent.initializeBase(this);this._type='material';}
GLSharp.Universe.MaterialComponent.prototype={$1:null,get_materialHandle:function(){return this.$1;},set_materialHandle:function(value){this.$1=value;return value;}}
GLSharp.Universe.Component=function(){}
GLSharp.Universe.Component.prototype={_type:null,get_type:function(){return this._type;},set_type:function(value){this._type=value;return value;},$0:null,get_parent:function(){return this.$0;},set_parent:function(value){this.$0=value;return value;}}
GLSharp.Universe.MeshComponent=function(){GLSharp.Universe.MeshComponent.initializeBase(this);this._type='mesh';}
GLSharp.Universe.MeshComponent.prototype={$1:null,get_meshHandle:function(){return this.$1;},set_meshHandle:function(value){this.$1=value;return value;}}
GLSharp.Universe.Node=function(){this.$4={};}
GLSharp.Universe.Node.prototype={add_componentAdded:function(value){this.$0=ss.Delegate.combine(this.$0,value);},remove_componentAdded:function(value){this.$0=ss.Delegate.remove(this.$0,value);},$0:null,add_componentRemoved:function(value){this.$1=ss.Delegate.combine(this.$1,value);},remove_componentRemoved:function(value){this.$1=ss.Delegate.remove(this.$1,value);},$1:null,add_childAdded:function(value){this.$2=ss.Delegate.combine(this.$2,value);},remove_childAdded:function(value){this.$2=ss.Delegate.remove(this.$2,value);},$2:null,add_childRemoved:function(value){this.$3=ss.Delegate.combine(this.$3,value);},remove_childRemoved:function(value){this.$3=ss.Delegate.remove(this.$3,value);},$3:null,$5:'Undefined',get_id:function(){return this.$5;},set_id:function(value){this.$5=value;return value;},$6:null,get_matrix:function(){return this.$6;},set_matrix:function(value){this.$6=value;return value;},$7:null,get_children:function(){if(this.$7==null){this.$7={};}return this.$7;},addComponent:function(component){this.$4[component.get_type()]=component;if(this.$0!=null){this.$0(this,component);}},removeComponent:function(component){delete this.$4[component.get_type()];if(this.$1!=null){this.$1(this,component);}},getComponent:function(type){return this.$4[type];},addChild:function(child){if(this.$7[child.get_id()]!=null){throw new Error('Child with the same name already exists.');}this.$7[child.get_id()]=child;if(this.$2!=null){this.$2(this,child);}},removeChild:function(child){if(this.$7[child.get_id()]==null){return false;}delete this.$7[child.get_id()];if(this.$3!=null){this.$3(this,child);}return true;},findChild:function(id,deep){return null;}}
GLSharp.Universe.World=function(){this.$0=[];}
GLSharp.Universe.World.prototype={$0:null,get_rootNodes:function(){return this.$0;},add_nodeAdded:function(value){this.$1=ss.Delegate.combine(this.$1,value);},remove_nodeAdded:function(value){this.$1=ss.Delegate.remove(this.$1,value);},$1:null,add_nodeRemoved:function(value){this.$2=ss.Delegate.combine(this.$2,value);},remove_nodeRemoved:function(value){this.$2=ss.Delegate.remove(this.$2,value);},$2:null,addNode:function(node){this.$0.add(node);if(this.$1!=null){this.$1(this,node);}},removeNode:function(node){this.$0.remove(node);if(this.$2!=null){this.$2(this,node);}}}
Type.registerNamespace('GLSharp.Util');GLSharp.Util.Matrix4X4=function(elements){this.$0=(elements==null)?GLSharp.Core.SystemCore.get_environment().createFloat32Array(16):GLSharp.Core.SystemCore.get_environment().createFloat32ArrayFromArray(elements);}
GLSharp.Util.Matrix4X4.prototype={$0:null,get_elements:function(){return this.$0;},set_elements:function(value){this.$0=value;return value;}}
Type.registerNamespace('GLSharp');GLSharp.Engine=function(){}
GLSharp.Engine.prototype={$0:null,get_activeGame:function(){return this.$0;},set_activeGame:function(value){this.$0=value;return value;},run:function(){if(this.get_activeGame()==null){throw new Error('No active game defined.');}this.get_activeGame().initialize();}}
Type.registerNamespace('GLSharp.Game');GLSharp.Game.GameBase=function(){}
GLSharp.Game.GameBase.prototype={$0:null,get_library:function(){return this.$0;},initialize:function(){this.$0=new GLSharp.Content.Library();this.$0.addConverter(new GLSharp.Content.LightConverter());this.$0.addConverter(new GLSharp.Content.MeshConverter());this.$0.addConverter(new GLSharp.Content.NodeConverter());this.startup();}}
Type.registerNamespace('GLSharp.Graphics');GLSharp.Graphics.ICompiledShader=function(){};GLSharp.Graphics.ICompiledShader.registerInterface('GLSharp.Graphics.ICompiledShader');GLSharp.Graphics.IUniform=function(){};GLSharp.Graphics.IUniform.registerInterface('GLSharp.Graphics.IUniform');GLSharp.Graphics.ClearMode=function(){};GLSharp.Graphics.ClearMode.prototype = {depth:256,stencil:1024,color:16384}
GLSharp.Graphics.ClearMode.registerEnum('GLSharp.Graphics.ClearMode',false);GLSharp.Graphics.IGraphics=function(){};GLSharp.Graphics.IGraphics.registerInterface('GLSharp.Graphics.IGraphics');GLSharp.Graphics.IShader=function(){};GLSharp.Graphics.IShader.registerInterface('GLSharp.Graphics.IShader');GLSharp.Graphics.IShaderProgram=function(){};GLSharp.Graphics.IShaderProgram.registerInterface('GLSharp.Graphics.IShaderProgram');GLSharp.Graphics.IUniformLocation=function(){};GLSharp.Graphics.IUniformLocation.registerInterface('GLSharp.Graphics.IUniformLocation');GLSharp.Graphics.Color=function(){}
GLSharp.Graphics.Color.create=function(red,green,blue,alpha){var $0=new GLSharp.Graphics.Color();$0.set_red(red);$0.set_green(green);$0.set_blue(blue);$0.set_alpha(alpha);return $0;}
GLSharp.Graphics.Color.prototype={$0:0,$1:0,$2:0,$3:1,get_red:function(){return this.$0;},set_red:function(value){this.$0=value;return value;},get_green:function(){return this.$1;},set_green:function(value){this.$1=value;return value;},get_blue:function(){return this.$2;},set_blue:function(value){this.$2=value;return value;},get_alpha:function(){return this.$3;},set_alpha:function(value){this.$3=value;return value;}}
GLSharp.Graphics.Material=function(){}
GLSharp.Graphics.Material.prototype={$0:null,get_shader:function(){return this.$0;},set_shader:function(value){this.$0=value;return value;}}
GLSharp.Graphics.Mesh=function(){}
GLSharp.Content.LightItem.registerClass('GLSharp.Content.LightItem');GLSharp.Content.LightConverter.registerClass('GLSharp.Content.LightConverter',null,GLSharp.Content.IResourceConverter);GLSharp.Content.MeshItem.registerClass('GLSharp.Content.MeshItem');GLSharp.Content.MeshConverter.registerClass('GLSharp.Content.MeshConverter',null,GLSharp.Content.IResourceConverter);GLSharp.Content.NodeConverter.registerClass('GLSharp.Content.NodeConverter',null,GLSharp.Content.IResourceConverter);GLSharp.Content.Handle.registerClass('GLSharp.Content.Handle');GLSharp.Content.Collection.registerClass('GLSharp.Content.Collection');GLSharp.Content.ResourceItem.registerClass('GLSharp.Content.ResourceItem');GLSharp.Content.Library.registerClass('GLSharp.Content.Library');GLSharp.Universe.Component.registerClass('GLSharp.Universe.Component');GLSharp.Universe.MaterialComponent.registerClass('GLSharp.Universe.MaterialComponent',GLSharp.Universe.Component);GLSharp.Universe.MeshComponent.registerClass('GLSharp.Universe.MeshComponent',GLSharp.Universe.Component);GLSharp.Universe.Node.registerClass('GLSharp.Universe.Node');GLSharp.Universe.World.registerClass('GLSharp.Universe.World');GLSharp.Util.Matrix4X4.registerClass('GLSharp.Util.Matrix4X4');GLSharp.Engine.registerClass('GLSharp.Engine');GLSharp.Game.GameBase.registerClass('GLSharp.Game.GameBase');GLSharp.Graphics.Color.registerClass('GLSharp.Graphics.Color');GLSharp.Graphics.Material.registerClass('GLSharp.Graphics.Material');GLSharp.Graphics.Mesh.registerClass('GLSharp.Graphics.Mesh');})();// This script was generated using Script# v0.7.4.0
