// Engine.js
(function(){
Type.registerNamespace('GLSharp.Content');GLSharp.Content.IResourceConverter=function(){};GLSharp.Content.IResourceConverter.registerInterface('GLSharp.Content.IResourceConverter');GLSharp.Content.LightItem=function(){GLSharp.Content.LightItem.initializeBase(this);}
GLSharp.Content.LightItem.prototype={lightType:0,properties:null,free:function(){this.alocated=false;return true;},readlocate:function(){this.alocated=true;return true;}}
GLSharp.Content.LightConverter=function(){}
GLSharp.Content.LightConverter.prototype={get_typeHandled:function(){return 'light';},convert:function(input,collection){var $0=input;var $1=new GLSharp.Content.LightItem();$1.lightType=$0.Type;$1.properties={};var $enum1=ss.IEnumerator.getEnumerator($0.Properties);while($enum1.moveNext()){var $2=$enum1.current;if($2.Key==='color'){var $3=$2.Value.split(' ');var $4=GLSharp.Core.SystemCore.environment.createFloat32Array($3.length);for(var $5=0;$5<$3.length;$5++){$4[$5]=parseFloat($3[$5]);}$1.properties['color']=$4;}else if($2.Key==='intensity'){$1.properties['intensity']=parseFloat($2.Value);}else if($2.Key==='falloff_angle'){$1.properties['falloff_angle']=parseFloat($2.Value);}}return $1;}}
GLSharp.Content.PropertyItem=function(){}
GLSharp.Content.PropertyItem.prototype={type:null,value:null}
GLSharp.Content.MaterialItem=function(){GLSharp.Content.MaterialItem.initializeBase(this);}
GLSharp.Content.MaterialItem.prototype={properties:null,shader:null,free:function(){this.alocated=false;return true;},readlocate:function(){this.alocated=true;return true;}}
GLSharp.Content.MaterialConverter=function(){}
GLSharp.Content.MaterialConverter.prototype={get_typeHandled:function(){return 'material';},convert:function(input,collection){var $0=new GLSharp.Content.MaterialItem();var $1=input;$0.properties={};$1.Properties.forEach(function($p1_0){
var $1_0=new GLSharp.Content.PropertyItem();if($p1_0.Type==='color'){$1_0.type='color';$1_0.value=$p1_0.Value.split(new RegExp('[^0-9.]+'));}else if($p1_0.Type==='float'){$1_0.type='float';$1_0.value=parseFloat($p1_0.Value);}else if($p1_0.Type==='texture'){var $1_1=new GLSharp.Content.Handle();$1_1.id=$p1_0.Value;$1_1.collection=collection;$1_0.type='texture';$1_0.value=$1_1;}$0.properties[$p1_0.Name]=$1_0;});$0.shader=$1.Shader;return $0;}}
GLSharp.Content.TextureItem=function(graphics){GLSharp.Content.TextureItem.initializeBase(this);this.$1=graphics;}
GLSharp.Content.TextureItem.prototype={texture:null,$1:null,image:null,free:function(){return !(this.alocated=!this.$1.allocateTexture(this));},readlocate:function(){return (this.alocated=this.$1.allocateTexture(this));}}
GLSharp.Content.TextureConverter=function(graphics){this.$0=graphics;}
GLSharp.Content.TextureConverter.prototype={$0:null,get_typeHandled:function(){return 'texture';},convert:function(input,collection){var $0=new GLSharp.Content.TextureItem(this.$0);var $1=input;GLSharp.Core.SystemCore.resourceManager.getResource($1.Url,null).resourceChanged.subscribe(function($p1_0,$p1_1){
var $1_0=$p1_0;$0.image=($1_0.get_data());},false);return $0;}}
GLSharp.Content.MeshItem=function(graphics){GLSharp.Content.MeshItem.initializeBase(this);this.$1=graphics;}
GLSharp.Content.MeshItem.prototype={indexes:null,mesh:null,offsetPosition:0,offsetNormal:0,offsetUv:0,boundingVolume:null,meshBuffer:null,indexBuffer:null,$1:null,free:function(){return !(this.alocated=!this.$1.allocateMesh(this));},readlocate:function(){return (this.alocated=this.$1.allocateMesh(this));},computeBoundingVolume:function(){var $0=new GLSharp.Util.Vector3(null);for(var $4=0;$4<this.offsetNormal;$4+=3){$0.add3(this.mesh[$4],this.mesh[$4+1],this.mesh[$4+2]);}$0.scale(1/(this.offsetNormal/3));var $1=-1;var $2=-1;var $3=-1;for(var $5=0;$5<this.offsetNormal;$5+=3){$2=$0.distance3(this.mesh[$5],this.mesh[$5+1],this.mesh[$5+2]);if($2>$3){$3=$2;$1=$5/3;}}this.boundingVolume=new GLSharp.Util.VertexBoundingVolume();this.boundingVolume.center=$0;this.boundingVolume.vertexIndex=$1;}}
GLSharp.Content.MeshConverter=function(graphics){this.$0=graphics;}
GLSharp.Content.MeshConverter.prototype={$0:null,get_typeHandled:function(){return 'mesh';},convert:function(input,collection){if(input==null){return null;}var $0=input;var $1=new GLSharp.Content.MeshItem(this.$0);if($0.Indexes==null){$0.Indexes=GLSharp.Core.SystemCore.environment.createUInt16Array(0);}if($0.Vertices==null){$0.Vertices=GLSharp.Core.SystemCore.environment.createFloat32Array(0);}if($0.Normals==null){$0.Normals=GLSharp.Core.SystemCore.environment.createFloat32Array(0);}if($0.UVs==null){$0.UVs=GLSharp.Core.SystemCore.environment.createFloat32Array(0);}$1.indexes=GLSharp.Core.SystemCore.environment.createUInt16ArrayFromArray($0.Indexes);$1.mesh=GLSharp.Core.SystemCore.environment.createFloat32Array(($0.Vertices.length+$0.Normals.length+$0.UVs.length));$1.offsetPosition=0;$1.offsetNormal=$0.Vertices.length;$1.offsetUv=$0.Vertices.length+$0.Normals.length;for(var $2=0;$2<$0.Vertices.length;$2++){$1.mesh[$2]=$0.Vertices[$2];}for(var $3=0;$3<$0.Normals.length;$3++){$1.mesh[$3+$1.offsetNormal]=$0.Normals[$3];}for(var $4=0;$4<$0.UVs.length;$4++){$1.mesh[$4+$1.offsetUv]=$0.UVs[$4];}$1.computeBoundingVolume();return $1;}}
GLSharp.Content.NodeItem=function(){GLSharp.Content.NodeItem.initializeBase(this);}
GLSharp.Content.NodeItem.prototype={root:null,free:function(){this.alocated=false;return true;},readlocate:function(){this.alocated=false;return true;}}
GLSharp.Content.NodeConverter=function(){}
GLSharp.Content.NodeConverter.prototype={get_typeHandled:function(){return 'node';},convert:function(input,collection){var $0=input;var $1=new GLSharp.Content.NodeItem();$1.root=this.$0($0,null);return $1;},$0:function($p0,$p1){var $0=new GLSharp.Universe.Node();$0.id=$p0.Id;if(!!$p0.RotateX){$0.rotateX($p0.RotateX);}if(!!$p0.RotateY){$0.rotateY($p0.RotateY);}if(!!$p0.RotateZ){$0.rotateZ($p0.RotateZ);}if($p0.Translation!=null){$0.translate(new GLSharp.Util.Vector3($p0.Translation));}if($p0.PivotTranslation!=null){$0.set_pivot(new GLSharp.Util.Vector3($p0.PivotTranslation));}if($p0.Scale!=null){$0.scale(new GLSharp.Util.Vector3($p0.Scale));}if($p1!=null){$p1.addChild($0);}if($p0.Animation!=null){$0.animation=new GLSharp.Universe.NodeAnimation();$0.animation.translateX=$p0.Animation.TranslateX;$0.animation.translateY=$p0.Animation.TranslateY;$0.animation.translateZ=$p0.Animation.TranslateZ;$0.animation.scaleX=$p0.Animation.ScaleX;$0.animation.scaleY=$p0.Animation.ScaleY;$0.animation.scaleZ=$p0.Animation.ScaleZ;$0.animation.rotateX=$p0.Animation.RotateX;$0.animation.rotateY=$p0.Animation.RotateY;$0.animation.rotateZ=$p0.Animation.RotateZ;$0.animation.frameCount=$p0.Animation.FrameCount;$0.animation.currentFrame=0;$0.animation.animationStart=0;$0.animation.animationEnd=$0.animation.frameCount;$0.animation.loop=true;}if($p0.Collision!=null){var $2=new GLSharp.Universe.CollisionComponent();$2.bodyDefinition=new Box2D.Dynamics.b2BodyDef();$2.fixtureDefinition=new Box2D.Dynamics.b2FixtureDef();if($p0.Collision.Static){$2.bodyDefinition.type=Box2D.Dynamics.B2BodyType.staticBody;}else{$2.bodyDefinition.type=Box2D.Dynamics.B2BodyType.dynamicBody;}$2.fixtureDefinition.density=1;$2.fixtureDefinition.friction=0.5;$2.fixtureDefinition.restitution=0.2;var $3=$0.get_world().clone();var $4=$3.transformV(GLSharp.Util.Vector3.build3(0,0,0));$2.bodyDefinition.position.x=$4.elements[0]+$p0.Collision.PositionX;$2.bodyDefinition.position.y=$4.elements[2]+$p0.Collision.PositionY;var $5=$3.transformV(GLSharp.Util.Vector3.build3(1,0,0)).subtract($4);$2.bodyDefinition.angle=Math.atan2($5.elements[2],$5.elements[0]);if($p0.Collision.Type==='sphere'){var $6=$p0.Collision;$2.fixtureDefinition.shape=new Box2D.Collision.Shapes.b2CircleShape($6.Radius);}else if($p0.Collision.Type==='ob'){var $7=$p0.Collision;$2.fixtureDefinition.shape=new Box2D.Collision.Shapes.b2PolygonShape();($2.fixtureDefinition.shape).SetAsBox($7.Width/2,$7.Height/2);}$0.addComponent($2);}if($p0.Children!=null){var $enum1=ss.IEnumerator.getEnumerator($p0.Children);while($enum1.moveNext()){var $8=$enum1.current;this.$0($8,$0);}}var $1=[];if($p0.References!=null){var $enum2=ss.IEnumerator.getEnumerator($p0.References);while($enum2.moveNext()){var $9=$enum2.current;this.$1($9,$1);}}var $enum3=ss.IEnumerator.getEnumerator($1);while($enum3.moveNext()){var $A=$enum3.current;$0.addComponent($A);}return $0;},$1:function($p0,$p1){if($p0.Type==='mesh'){var $0=new GLSharp.Universe.MeshComponent();var $1=new GLSharp.Content.Handle();$1.collection=$p0.Library;$1.id=$p0.Resource;$0.meshHandle=$1;$p1.add($0);}else if($p0.Type==='material'){var $2=new GLSharp.Universe.MaterialComponent();var $3=new GLSharp.Content.Handle();$3.collection=$p0.Library;$3.id=$p0.Resource;$2.materialHandle=$3;$p1.add($2);}else if($p0.Type==='light'){var $4=new GLSharp.Universe.LightComponent();var $5=new GLSharp.Content.Handle();$5.collection=$p0.Library;$5.id=$p0.Resource;$4.lightHandle=$5;$p1.add($4);}if($p0.Children!=null){var $enum1=ss.IEnumerator.getEnumerator($p0.Children);while($enum1.moveNext()){var $6=$enum1.current;this.$1($6,$p1);}}}}
GLSharp.Content.Handle=function(){}
GLSharp.Content.Handle.create=function(library,id){var $0=new GLSharp.Content.Handle();$0.collection=library;$0.id=id;return $0;}
GLSharp.Content.Handle.prototype={collection:null,id:null}
GLSharp.Content.ResourceCollection=function(){}
GLSharp.Content.ResourceCollection.prototype={name:null,resources:null}
GLSharp.Content.ResourceItem=function(){this.itemId=GLSharp.Content.ResourceItem.$0++;}
GLSharp.Content.ResourceItem.prototype={id:null,type:null,lastAccessed:0,itemId:0,alocated:false}
GLSharp.Content.LibraryResult=function(){this.finished=new GLSharp.Core.Event();}
GLSharp.Content.Library=function(){this.$0={};this.$1={};this.$2=[];this.$3=[];this.$4=[];this.$5=Date.get_now().getTime();}
GLSharp.Content.Library.prototype={$0:null,$1:null,$2:null,expireLimit:600000,$3:null,$4:null,$5:0,update:function(){this.$4.clear();this.$5=Date.get_now().getTime();var $0=this;this.$3.forEach(function($p1_0){
if(($0.$5-$p1_0.lastAccessed)>$0.expireLimit){$0.$4.add($p1_0);}});$0.$4.forEach(function($p1_0){
if($p1_0.free()){$0.$3.remove($p1_0);}});},loadLibrary:function(url){var $0=new GLSharp.Data.ResourceManagerParams();var $1=new GLSharp.Content.LibraryResult();var $2=this;$0.set_type('json');GLSharp.Core.SystemCore.resourceManager.getResource(url,$0).resourceChanged.subscribe(ss.Delegate.create(this,function($p1_0,$p1_1){
var $1_0=$p1_0;if($1_0.get_finished()){var $1_1=this.$6($1_0.get_data());$1.finished.fire(this,$1_1);}}),true);return $1;},$6:function($p0){var $0=$p0;GLSharp.Core.SystemCore.logger.log('Loading library : '+$0.Name);var $1=null;if(($1=this.$0[$0.Name])==null){$1=new GLSharp.Content.ResourceCollection();$1.name=$0.Name;$1.resources={};this.$0[$1.name]=$1;}this.$7($1,$0.ContentObjects);return $1;},$7:function($p0,$p1){var $enum1=ss.IEnumerator.getEnumerator($p1);while($enum1.moveNext()){var $0=$enum1.current;var $1=this.$1[$0.Type];if($1==null){GLSharp.Core.SystemCore.logger.log('No resource converter found for type + '+$0.Type);continue;}var $2=$1.convert($0.Resource,$p0.name);$2.id=$0.Id;$2.type=$0.Type;$p0.resources[$2.id]=$2;this.$2[$2.itemId]=$2;}},unloadLibrary:function(name){},findResource:function(library,resourceName){var $0=null;if(($0=this.$0[library])==null){return null;}var $1=null;if(($1=$0.resources[resourceName])==null){return null;}return GLSharp.Content.Handle.create(library,resourceName);},getResourceById:function(itemId){return this.$2[itemId];},getResource:function(handle){if(this.$0[handle.collection]==null){return null;}var $0=this.$0[handle.collection].resources[handle.id];if($0==null){return null;}if(!$0.alocated){if($0.readlocate()){this.$3.add($0);}}$0.lastAccessed=this.$5;return $0;},addConverter:function(converter){this.$1[converter.get_typeHandled()]=converter;},removeConverter:function(converter){delete this.$1[converter.get_typeHandled()];}}
Type.registerNamespace('GLSharp.Graphics');GLSharp.Graphics.IShaderBinder=function(){};GLSharp.Graphics.IShaderBinder.registerInterface('GLSharp.Graphics.IShaderBinder');GLSharp.Graphics.IViewOccluder=function(){};GLSharp.Graphics.IViewOccluder.registerInterface('GLSharp.Graphics.IViewOccluder');GLSharp.Graphics.IRenderBuffer=function(){};GLSharp.Graphics.IRenderBuffer.registerInterface('GLSharp.Graphics.IRenderBuffer');GLSharp.Graphics.IActiveInfo=function(){};GLSharp.Graphics.IActiveInfo.registerInterface('GLSharp.Graphics.IActiveInfo');GLSharp.Graphics.IBuffer=function(){};GLSharp.Graphics.IBuffer.registerInterface('GLSharp.Graphics.IBuffer');GLSharp.Graphics.IFrameBuffer=function(){};GLSharp.Graphics.IFrameBuffer.registerInterface('GLSharp.Graphics.IFrameBuffer');GLSharp.Graphics.ITexture=function(){};GLSharp.Graphics.ITexture.registerInterface('GLSharp.Graphics.ITexture');GLSharp.Graphics.IUniform=function(){};GLSharp.Graphics.IUniform.registerInterface('GLSharp.Graphics.IUniform');GLSharp.Graphics.ClearMode=function(){};GLSharp.Graphics.ClearMode.prototype = {depth:256,stencil:1024,color:16384}
GLSharp.Graphics.ClearMode.registerEnum('GLSharp.Graphics.ClearMode',false);GLSharp.Graphics.IGraphics=function(){};GLSharp.Graphics.IGraphics.registerInterface('GLSharp.Graphics.IGraphics');GLSharp.Graphics.IShader=function(){};GLSharp.Graphics.IShader.registerInterface('GLSharp.Graphics.IShader');GLSharp.Graphics.IShaderProgram=function(){};GLSharp.Graphics.IShaderProgram.registerInterface('GLSharp.Graphics.IShaderProgram');GLSharp.Graphics.IUniformLocation=function(){};GLSharp.Graphics.IUniformLocation.registerInterface('GLSharp.Graphics.IUniformLocation');GLSharp.Graphics.CullInfo=function(){this.nearClip=GLSharp.Core.SystemCore.environment.createFloat32Array(4);this.farClip=GLSharp.Core.SystemCore.environment.createFloat32Array(4);this.leftClip=GLSharp.Core.SystemCore.environment.createFloat32Array(4);this.rightClip=GLSharp.Core.SystemCore.environment.createFloat32Array(4);this.botClip=GLSharp.Core.SystemCore.environment.createFloat32Array(4);this.topClip=GLSharp.Core.SystemCore.environment.createFloat32Array(4);}
GLSharp.Graphics.CullInfo.prototype={modelView:null}
GLSharp.Graphics.RegionOccluder=function(regionX,regionY){this.$0=regionX;this.$1=regionY;}
GLSharp.Graphics.RegionOccluder.prototype={$0:0,$1:0,test:function(cullInfo,node,meshItem){var $0=meshItem.boundingVolume.center.elements[0];var $1=meshItem.boundingVolume.center.elements[1];var $2=meshItem.boundingVolume.center.elements[2];var $3=$0*cullInfo.modelView[0]+$1*cullInfo.modelView[4]+$2*cullInfo.modelView[8]+cullInfo.modelView[12];var $4=$0*cullInfo.modelView[1]+$1*cullInfo.modelView[5]+$2*cullInfo.modelView[9]+cullInfo.modelView[13];var $5=$0*cullInfo.modelView[2]+$1*cullInfo.modelView[6]+$2*cullInfo.modelView[10]+cullInfo.modelView[14];var $6=meshItem.mesh[meshItem.boundingVolume.vertexIndex*3];var $7=meshItem.mesh[meshItem.boundingVolume.vertexIndex*3+1];var $8=meshItem.mesh[meshItem.boundingVolume.vertexIndex*3+2];var $9=$6*cullInfo.modelView[0]+$7*cullInfo.modelView[4]+$8*cullInfo.modelView[8]+cullInfo.modelView[12];var $A=$6*cullInfo.modelView[1]+$7*cullInfo.modelView[5]+$8*cullInfo.modelView[9]+cullInfo.modelView[13];var $B=$6*cullInfo.modelView[2]+$7*cullInfo.modelView[6]+$8*cullInfo.modelView[10]+cullInfo.modelView[14];var $C=Math.sqrt(($3-$9)*($3-$9)+($4-$A)*($4-$A)+($5-$B)*($5-$B));if($3+$C<-this.$0){return false;}if($3-$C>this.$0){return false;}if($4+$C<-this.$1){return false;}if($4-$C>this.$1){return false;}return true;}}
GLSharp.Graphics.ViewFrustrumOccluder=function(){}
GLSharp.Graphics.ViewFrustrumOccluder.prototype={test:function(cullInfo,node,meshItem){var $0=meshItem.boundingVolume.center.elements[0];var $1=meshItem.boundingVolume.center.elements[1];var $2=meshItem.boundingVolume.center.elements[2];var $3=$0*cullInfo.modelView[0]+$1*cullInfo.modelView[4]+$2*cullInfo.modelView[8]+cullInfo.modelView[12];var $4=$0*cullInfo.modelView[1]+$1*cullInfo.modelView[5]+$2*cullInfo.modelView[9]+cullInfo.modelView[13];var $5=$0*cullInfo.modelView[2]+$1*cullInfo.modelView[6]+$2*cullInfo.modelView[10]+cullInfo.modelView[14];var $6=meshItem.mesh[meshItem.boundingVolume.vertexIndex*3];var $7=meshItem.mesh[meshItem.boundingVolume.vertexIndex*3+1];var $8=meshItem.mesh[meshItem.boundingVolume.vertexIndex*3+2];var $9=$6*cullInfo.modelView[0]+$7*cullInfo.modelView[4]+$8*cullInfo.modelView[8]+cullInfo.modelView[12];var $A=$6*cullInfo.modelView[1]+$7*cullInfo.modelView[5]+$8*cullInfo.modelView[9]+cullInfo.modelView[13];var $B=$6*cullInfo.modelView[2]+$7*cullInfo.modelView[6]+$8*cullInfo.modelView[10]+cullInfo.modelView[14];var $C=Math.sqrt(($3-$9)*($3-$9)+($4-$A)*($4-$A)+($5-$B)*($5-$B));if(($3*cullInfo.nearClip[0]+$4*cullInfo.nearClip[1]+$5*cullInfo.nearClip[2]+cullInfo.nearClip[3]+$C)<0){return false;}if(($3*cullInfo.botClip[0]+$4*cullInfo.botClip[1]+$5*cullInfo.botClip[2]+cullInfo.botClip[3]+$C)<0){return false;}if(($3*cullInfo.topClip[0]+$4*cullInfo.topClip[1]+$5*cullInfo.topClip[2]+cullInfo.topClip[3]+$C)<0){return false;}if(($3*cullInfo.leftClip[0]+$4*cullInfo.leftClip[1]+$5*cullInfo.leftClip[2]+cullInfo.leftClip[3]+$C)<0){return false;}if(($3*cullInfo.rightClip[0]+$4*cullInfo.rightClip[1]+$5*cullInfo.rightClip[2]+cullInfo.rightClip[3]+$C)<0){return false;}if(($3*cullInfo.farClip[0]+$4*cullInfo.farClip[1]+$5*cullInfo.farClip[2]+cullInfo.farClip[3]+$C)<0){return false;}return true;}}
GLSharp.Graphics.ShaderGroup=function(){}
GLSharp.Graphics.ShaderGroup.prototype={name:null,geometryPassShader:null,finalPassShader:null,lightPassShader:null,prePostProcessPassShader:null,shaderBinder:null}
GLSharp.Graphics.CompiledShader=function(){}
GLSharp.Graphics.CompiledShader.prototype={name:null,shaderProgram:null,uniforms:null,attributes:null}
GLSharp.Graphics.Color=function(){}
GLSharp.Graphics.Color.create=function(red,green,blue,alpha){var $0=new GLSharp.Graphics.Color();$0.set_red(red);$0.set_green(green);$0.set_blue(blue);$0.set_alpha(alpha);return $0;}
GLSharp.Graphics.Color.prototype={$0:0,$1:0,$2:0,$3:1,get_red:function(){return this.$0;},set_red:function(value){this.$0=value;return value;},get_green:function(){return this.$1;},set_green:function(value){this.$1=value;return value;},get_blue:function(){return this.$2;},set_blue:function(value){this.$2=value;return value;},get_alpha:function(){return this.$3;},set_alpha:function(value){this.$3=value;return value;}}
Type.registerNamespace('GLSharp.Graphics.Core');GLSharp.Graphics.Core.RenderGroup=function(){}
GLSharp.Graphics.Core.RenderGroup.prototype={frameBuffer:null,renderTexture:null,depthRenderBuffer:null}
Type.registerNamespace('GLSharp.Graphics.Effects');GLSharp.Graphics.Effects.IPostProcessEffect=function(){};GLSharp.Graphics.Effects.IPostProcessEffect.registerInterface('GLSharp.Graphics.Effects.IPostProcessEffect');GLSharp.Graphics.Effects.BloomEffect=function(){var $0=this;GLSharp.Core.SystemCore.resourceManager.getResource('/Data/Shader/phong_pass_bloom.shader',null).resourceChanged.subscribe(function($p1_0,$p1_1){
var $1_0=$p1_0;$0.$0=$1_0.get_data();},true);}
GLSharp.Graphics.Effects.BloomEffect.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:true,$7:null,get_active:function(){return this.$6;},set_active:function(value){this.$6=value;return value;},reset:function(graphics){this.$1=graphics.createRenderGroup(true);this.$7=graphics;},init:function(diffuse,normal,position,accumulation){this.$2=diffuse;this.$3=normal;this.$4=position;this.$5=accumulation;},render:function(previous){if(!this.$6){return previous;}this.$8();this.$7.switchRenderGroup(this.$1);this.$7.renderPostProcess();return this.$1;},$8:function(){if(this.$0==null){return;}this.$7.bindShader(this.$0);this.$7.bindTexture(this.$0.uniforms['uSDiffuse'],this.$2,0);this.$7.bindTexture(this.$0.uniforms['uSAccumulation'],this.$5,1);}}
GLSharp.Graphics.Effects.DepthEffect=function(){var $0=this;GLSharp.Core.SystemCore.resourceManager.getResource('/Data/Shader/phong_pass_depth.shader',null).resourceChanged.subscribe(function($p1_0,$p1_1){
var $1_0=$p1_0;$0.$0=$1_0.get_data();},true);}
GLSharp.Graphics.Effects.DepthEffect.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:true,$7:null,get_active:function(){return this.$6;},set_active:function(value){this.$6=value;return value;},reset:function(graphics){this.$1=graphics.createRenderGroup(true);this.$7=graphics;},init:function(diffuse,normal,position,accumulation){this.$2=diffuse;this.$3=normal;this.$4=position;this.$5=accumulation;},render:function(previous){if(!this.$6){return previous;}this.$8(previous);this.$7.switchRenderGroup(this.$1);this.$7.renderPostProcess();return this.$1;},$8:function($p0){if(this.$0==null){return;}this.$7.bindShader(this.$0);this.$7.bindTexture(this.$0.uniforms['uSPost'],$p0.renderTexture,0);}}
GLSharp.Graphics.Effects.MotionBlurEffect=function(){var $0=this;GLSharp.Core.SystemCore.resourceManager.getResource('/Data/Shader/phong_pass_blur.shader',null).resourceChanged.subscribe(function($p1_0,$p1_1){
var $1_0=$p1_0;$0.$0=$1_0.get_data();},true);}
GLSharp.Graphics.Effects.MotionBlurEffect.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:true,$7:null,get_active:function(){return this.$6;},set_active:function(value){this.$6=value;return value;},reset:function(graphics){this.$1=graphics.createRenderGroup(true);this.$7=graphics;},init:function(diffuse,normal,position,accumulation){this.$2=diffuse;this.$3=normal;this.$4=position;this.$5=accumulation;},render:function(previous){if(!this.$6){return previous;}this.$8(previous);this.$7.switchRenderGroup(this.$1);this.$7.renderPostProcess();return this.$1;},$8:function($p0){if(this.$0==null){return;}this.$7.bindShader(this.$0);this.$7.bindTexture(this.$0.uniforms['uSPost'],this.$1.renderTexture,0);this.$7.bindTexture(this.$0.uniforms['uSCurrent'],$p0.renderTexture,1);}}
GLSharp.Graphics.Effects.SsaoEffect=function(){var $0=this;GLSharp.Core.SystemCore.resourceManager.getResource('/Data/Shader/phong_pass_ssao.shader',null).resourceChanged.subscribe(function($p1_0,$p1_1){
var $1_0=$p1_0;$0.$0=$1_0.get_data();},true);GLSharp.Core.SystemCore.resourceManager.getResource('/Data/Shader/phong_pass_ssao_composite.shader',null).resourceChanged.subscribe(function($p1_0,$p1_1){
var $1_0=$p1_0;$0.$1=$1_0.get_data();},true);}
GLSharp.Graphics.Effects.SsaoEffect.prototype={$0:null,$1:null,$2:null,$3:null,$4:null,$5:null,$6:null,$7:null,$8:true,$9:null,get_active:function(){return this.$8;},set_active:function(value){this.$8=value;return value;},reset:function(graphics){this.$2=graphics.createRenderGroup(true);this.$3=graphics.createRenderGroup(true);this.$9=graphics;},init:function(diffuse,normal,position,accumulation){this.$4=diffuse;this.$5=normal;this.$6=position;this.$7=accumulation;},render:function(previous){if(!this.$8){return previous;}this.$A();this.$9.switchRenderGroup(this.$2);this.$9.renderPostProcess();this.$B(previous);this.$9.switchRenderGroup(this.$3);this.$9.renderPostProcess();return this.$3;},$A:function(){if(this.$0==null){return;}this.$9.bindShader(this.$0);this.$9.bindTexture(this.$0.uniforms['uSPosition'],this.$6,0);},$B:function($p0){if(this.$1==null){return;}this.$9.bindShader(this.$1);this.$9.bindTexture(this.$1.uniforms['uSPost'],$p0.renderTexture,0);this.$9.bindTexture(this.$1.uniforms['uSAccumulation'],this.$2.renderTexture,1);}}
Type.registerNamespace('GLSharp.Universe');GLSharp.Universe.CameraComponent=function(){GLSharp.Universe.CameraComponent.initializeBase(this);this.type='camera';}
GLSharp.Universe.CollisionComponent=function(){GLSharp.Universe.CollisionComponent.initializeBase(this);this.type='collision';}
GLSharp.Universe.CollisionComponent.prototype={body:null,bodyDefinition:null,fixtureDefinition:null}
GLSharp.Universe.ControllerBase=function(){}
GLSharp.Universe.ControllerBase.prototype={parent:null,bind:function(parent){this.parent=parent;this.bindParent();}}
GLSharp.Universe.LightComponent=function(){GLSharp.Universe.LightComponent.initializeBase(this);this.type='light';}
GLSharp.Universe.LightComponent.prototype={lightHandle:null}
GLSharp.Universe.MaterialComponent=function(){GLSharp.Universe.MaterialComponent.initializeBase(this);this.type='material';}
GLSharp.Universe.MaterialComponent.prototype={materialHandle:null}
GLSharp.Universe.ComponentCollection=function(){this.$0={};this.$1=[];}
GLSharp.Universe.ComponentCollection.prototype={addKnownType:function(type){this.$1.add(type);},removeKnowType:function(type){this.$1.remove(type);delete this.$0[type];},addComponent:function(component){if(!this.$1.contains(component.type)){return false;}this.$0[component.type].add(component);return true;},removeComponent:function(component){if(!this.$1.contains(component.type)){return false;}return this.$0[component.type].remove(component);},getCollection:function(type){if(!this.$1.contains(type)){return null;}return this.$0[type];}}
GLSharp.Universe.Component=function(){this.id=GLSharp.Universe.Component.$0++;}
GLSharp.Universe.Component.prototype={type:null,parent:null,id:0}
GLSharp.Universe.MeshComponent=function(){GLSharp.Universe.MeshComponent.initializeBase(this);this.type='mesh';}
GLSharp.Universe.MeshComponent.prototype={meshHandle:null}
GLSharp.Universe.NodeAnimation=function(){}
GLSharp.Universe.NodeAnimation.prototype={frameCount:0,currentFrame:0,animationStart:0,animationEnd:0,loop:false,translateX:null,translateY:null,translateZ:null,rotateX:null,rotateY:null,rotateZ:null,scaleX:null,scaleY:null,scaleZ:null}
GLSharp.Universe.NodeAnimationGroup=function(){this.animations=[];}
GLSharp.Universe.NodeAnimationGroup.prototype={setStartFrame:function(frame,resetCurrent){var $0=this;if(resetCurrent){this.animations.forEach(function($p1_0){
$p1_0.animationStart=frame;$p1_0.currentFrame=frame;});}else{this.animations.forEach(function($p1_0){
$p1_0.animationStart=frame;});}},setEndFrame:function(frame){var $0=this;this.animations.forEach(function($p1_0){
$p1_0.animationEnd=frame;if($p1_0.currentFrame>=frame&&$p1_0.loop){$p1_0.currentFrame=$p1_0.animationStart;}});},setRange:function(start,end,resetCurrent){var $0=this;if(resetCurrent){this.animations.forEach(function($p1_0){
$p1_0.animationStart=start;$p1_0.animationEnd=end;$p1_0.currentFrame=start;});}else{this.animations.forEach(function($p1_0){
$p1_0.animationStart=start;$p1_0.animationEnd=end;});}},setLoop:function(loop){var $0=this;this.animations.forEach(function($p1_0){
$p1_0.loop=loop;});},resetAnimation:function(){var $0=this;this.animations.forEach(function($p1_0){
$p1_0.currentFrame=$p1_0.animationStart;});}}
GLSharp.Universe.Node=function(){this.componentAdded=new GLSharp.Core.Event();this.componentRemoved=new GLSharp.Core.Event();this.childAdded=new GLSharp.Core.Event();this.childRemoved=new GLSharp.Core.Event();this.transformChanged=new GLSharp.Core.Event();this.$0={};this.children={};this.childrenList=[];this.$2=true;this.$3=GLSharp.Util.Matrix4X4.get_identity().clone();this.$5=GLSharp.Util.Matrix4X4.get_identity().clone();this.$4=GLSharp.Util.Matrix4X4.get_identity().clone();this.$6=GLSharp.Util.Matrix4X4.get_identity().clone();this.$1=new GLSharp.Util.Matrix4X4(null);this.localTranslation=new GLSharp.Util.Vector3(null);this.localScale=new GLSharp.Util.Vector3(null);this.localRotation=new GLSharp.Util.Vector3(null);this.set_pivot(new GLSharp.Util.Vector3(null));}
GLSharp.Universe.Node.prototype={get_components:function(){return this.$0;},id:null,$1:null,$2:false,get_world:function(){if(this.$2){this.$A();}return this.$1;},$3:null,$4:null,$5:null,$6:null,$7:null,$8:null,get_local:function(){if(this.$2){this.$A();}return this.$6;},$9:null,get_pivot:function(){return this.$9;},set_pivot:function(value){this.$9=value;this.$7=GLSharp.Util.Matrix4X4.get_identity().clone().translate(this.$9);this.$8=GLSharp.Util.Matrix4X4.get_identity().clone().translateInverse(this.$9);return value;},localTranslation:null,localRotation:null,localScale:null,animation:null,parent:null,controller:null,$A:function(){if(this.animation!=null){this.$4.setTranslate3(this.animation.translateX[this.animation.currentFrame]+this.localTranslation.elements[0],this.animation.translateY[this.animation.currentFrame]+this.localTranslation.elements[1],this.animation.translateZ[this.animation.currentFrame]+this.localTranslation.elements[2]);this.$5.setScale3(this.animation.scaleX[this.animation.currentFrame]+this.localScale.elements[0],this.animation.scaleY[this.animation.currentFrame]+this.localScale.elements[1],this.animation.scaleZ[this.animation.currentFrame]+this.localScale.elements[2]);this.$3.setRotation3(this.animation.rotateX[this.animation.currentFrame]+this.localRotation.elements[0],this.animation.rotateY[this.animation.currentFrame]+this.localRotation.elements[1],this.animation.rotateZ[this.animation.currentFrame]+this.localRotation.elements[2]);}this.$4.copy(this.$6);this.$6.multiplyM2(this.$7,this.$6);this.$6.multiplyM2(this.$3,this.$6);this.$6.multiplyM2(this.$8,this.$6);this.$6.multiplyM2(this.$5,this.$6);if(this.parent!=null){this.parent.get_world().multiplyM2(this.$6,this.$1);}else{this.$1=this.$6;}this.$2=false;},invalidateWorldTransformation:function(){this.$2=true;this.childrenList.forEach(function($p1_0){
$p1_0.invalidateWorldTransformation();});},addComponent:function(component){component.parent=this;this.$0[component.type]=component;this.componentAdded.fire(this,component);},removeComponent:function(component){component.parent=null;delete this.$0[component.type];this.componentRemoved.fire(this,component);},getComponent:function(type){return this.$0[type];},addChild:function(child){if(this.children[child.id]!=null){throw new Error('Child with the same name already exists.');}this.children[child.id]=child;this.childrenList.add(child);child.parent=this;this.childAdded.fire(this,child);},removeChild:function(child){if(this.children[child.id]==null){return false;}delete this.children[child.id];this.childrenList.remove(child);child.parent=null;this.childRemoved.fire(this,child);return true;},findChild:function(id,deep){if(this.id===id){return this;}if(this.children[id]!=null){return this.children[id];}if(!deep){return null;}var $dict1=this.children;for(var $key2 in $dict1){var $0={key:$key2,value:$dict1[$key2]};var $1=$0.value.findChild(id,deep);if($1!=null){return $1;}}return null;},translate:function(distance){this.localTranslation.add(distance);this.$4.translate(distance);this.invalidateWorldTransformation();this.transformChanged.fire(this,null);},translate3:function(x,y,z){this.localTranslation.add3(x,y,z);this.$4.translate3(x,y,z);this.invalidateWorldTransformation();this.transformChanged.fire(this,null);},rotate:function(angle,axis){this.localRotation.add(axis.clone().scale(angle));this.$3.rotate(angle,axis);this.invalidateWorldTransformation();this.transformChanged.fire(this,null);},rotateX:function(angle){this.localRotation.elements[0]+=angle;this.$3.rotateX(angle);this.invalidateWorldTransformation();this.transformChanged.fire(this,null);},rotateY:function(angle){this.localRotation.elements[1]+=angle;this.$3.rotateY(angle);this.invalidateWorldTransformation();this.transformChanged.fire(this,null);},rotateZ:function(angle){this.localRotation.elements[2]+=angle;this.$3.rotateZ(angle);this.invalidateWorldTransformation();this.transformChanged.fire(this,null);},scale:function(scale){this.localScale.multVect(scale);this.$5.scale(scale);this.invalidateWorldTransformation();this.transformChanged.fire(this,null);},bindController:function(controller){this.controller=controller;controller.bind(this);}}
GLSharp.Universe.World=function(){this.$0=[];this.nodeAdded=new GLSharp.Core.Event();this.nodeRemoved=new GLSharp.Core.Event();this.reset();}
GLSharp.Universe.World.prototype={get_rootNodes:function(){return this.$0;},reset:function(){},addRootNode:function(node){if(node==null){throw new Error('Node cannot be null.');}this.$0.add(node);this.nodeAdded.fire(this,node);},removeNode:function(node){if(node==null){return;}this.$0.remove(node);this.nodeRemoved.fire(this,node);}}
Type.registerNamespace('GLSharp.Util');GLSharp.Util.Matrix4X4=function(elements){this.elements=(elements==null)?GLSharp.Core.SystemCore.environment.createFloat32Array(16):GLSharp.Core.SystemCore.environment.createFloat32ArrayFromArray(elements);}
GLSharp.Util.Matrix4X4.get_identity=function(){return GLSharp.Util.Matrix4X4.$0||(GLSharp.Util.Matrix4X4.$0=new GLSharp.Util.Matrix4X4([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]));}
GLSharp.Util.Matrix4X4.makeFrustrum=function(left,right,bottom,top,znear,zfar){var $0=new GLSharp.Util.Matrix4X4(null);var $1=(right-left);var $2=(top-bottom);var $3=(zfar-znear);$0.elements[0]=(znear*2)/$1;$0.elements[1]=0;$0.elements[2]=0;$0.elements[3]=0;$0.elements[4]=0;$0.elements[5]=(znear*2)/$2;$0.elements[6]=0;$0.elements[7]=0;$0.elements[8]=(right+left)/$1;$0.elements[9]=(top+bottom)/$2;$0.elements[10]=-(zfar+znear)/$3;$0.elements[11]=-1;$0.elements[12]=0;$0.elements[13]=0;$0.elements[14]=-(zfar*znear*2)/$3;$0.elements[15]=0;return $0;}
GLSharp.Util.Matrix4X4.makePerspective=function(fov,aspect,znear,zfar){var $0=znear*Math.tan(fov*Math.PI/360);var $1=$0*aspect;return GLSharp.Util.Matrix4X4.makeFrustrum(-$1,$1,-$0,$0,znear,zfar);}
GLSharp.Util.Matrix4X4.makeOrtho=function(left,right,bottom,top,znear,zfar){var $0=new GLSharp.Util.Matrix4X4(null);var $1=(right-left);var $2=(top-bottom);var $3=(zfar-znear);$0.elements[0]=2/$1;$0.elements[1]=0;$0.elements[2]=0;$0.elements[3]=0;$0.elements[4]=0;$0.elements[5]=2/$2;$0.elements[6]=0;$0.elements[7]=0;$0.elements[8]=0;$0.elements[9]=0;$0.elements[10]=-2/$3;$0.elements[11]=0;$0.elements[12]=-(left+right)/$1;$0.elements[13]=-(top+bottom)/$2;$0.elements[14]=-(zfar+znear)/$3;$0.elements[15]=1;return $0;}
GLSharp.Util.Matrix4X4.makeLookAt=function(eye,center,up){var $0=new GLSharp.Util.Matrix4X4(null);var $1=eye.elements[0],$2=eye.elements[1],$3=eye.elements[2],$4=up.elements[0],$5=up.elements[1],$6=up.elements[2],$7=center.elements[0],$8=center.elements[1],$9=center.elements[2];var $A,$B,$C,$D,$E,$F,$10,$11,$12,$13;$A=$1-center.elements[0];$B=$2-center.elements[1];$C=$3-center.elements[2];$13=1/Math.sqrt($A*$A+$B*$B+$C*$C);$A*=$13;$B*=$13;$C*=$13;$D=$5*$C-$6*$B;$E=$6*$A-$4*$C;$F=$4*$B-$5*$A;$13=Math.sqrt($D*$D+$E*$E+$F*$F);if(!$13){$D=0;$E=0;$F=0;}else{$13=1/$13;$D*=$13;$E*=$13;$F*=$13;}$10=$B*$F-$C*$E;$11=$C*$D-$A*$F;$12=$A*$E-$B*$D;$13=Math.sqrt($10*$10+$11*$11+$12*$12);if(!$13){$10=0;$11=0;$12=0;}else{$13=1/$13;$10*=$13;$11*=$13;$12*=$13;}$0.elements[0]=$D;$0.elements[1]=$10;$0.elements[2]=$A;$0.elements[3]=0;$0.elements[4]=$E;$0.elements[5]=$11;$0.elements[6]=$B;$0.elements[7]=0;$0.elements[8]=$F;$0.elements[9]=$12;$0.elements[10]=$C;$0.elements[11]=0;$0.elements[12]=-($D*$1+$E*$2+$F*$3);$0.elements[13]=-($10*$1+$11*$2+$12*$3);$0.elements[14]=-($A*$1+$B*$2+$C*$3);$0.elements[15]=1;return $0;}
GLSharp.Util.Matrix4X4.prototype={elements:null,multiplyM:function(other){var $0=this.elements[0],$1=this.elements[1],$2=this.elements[2],$3=this.elements[3];var $4=this.elements[4],$5=this.elements[5],$6=this.elements[6],$7=this.elements[7];var $8=this.elements[8],$9=this.elements[9],$A=this.elements[10],$B=this.elements[11];var $C=this.elements[12],$D=this.elements[13],$E=this.elements[14],$F=this.elements[15];var $10=other.elements[0],$11=other.elements[1],$12=other.elements[2],$13=other.elements[3];var $14=other.elements[4],$15=other.elements[5],$16=other.elements[6],$17=other.elements[7];var $18=other.elements[8],$19=other.elements[9],$1A=other.elements[10],$1B=other.elements[11];var $1C=other.elements[12],$1D=other.elements[13],$1E=other.elements[14],$1F=other.elements[15];this.elements[0]=$10*$0+$11*$4+$12*$8+$13*$C;this.elements[1]=$10*$1+$11*$5+$12*$9+$13*$D;this.elements[2]=$10*$2+$11*$6+$12*$A+$13*$E;this.elements[3]=$10*$3+$11*$7+$12*$B+$13*$F;this.elements[4]=$14*$0+$15*$4+$16*$8+$17*$C;this.elements[5]=$14*$1+$15*$5+$16*$9+$17*$D;this.elements[6]=$14*$2+$15*$6+$16*$A+$17*$E;this.elements[7]=$14*$3+$15*$7+$16*$B+$17*$F;this.elements[8]=$18*$0+$19*$4+$1A*$8+$1B*$C;this.elements[9]=$18*$1+$19*$5+$1A*$9+$1B*$D;this.elements[10]=$18*$2+$19*$6+$1A*$A+$1B*$E;this.elements[11]=$18*$3+$19*$7+$1A*$B+$1B*$F;this.elements[12]=$1C*$0+$1D*$4+$1E*$8+$1F*$C;this.elements[13]=$1C*$1+$1D*$5+$1E*$9+$1F*$D;this.elements[14]=$1C*$2+$1D*$6+$1E*$A+$1F*$E;this.elements[15]=$1C*$3+$1D*$7+$1E*$B+$1F*$F;return this;},multiplyMInv:function(other){var $0=this.elements[0],$1=this.elements[1],$2=this.elements[2],$3=this.elements[3];var $4=this.elements[4],$5=this.elements[5],$6=this.elements[6],$7=this.elements[7];var $8=this.elements[8],$9=this.elements[9],$A=this.elements[10],$B=this.elements[11];var $C=this.elements[12],$D=this.elements[13],$E=this.elements[14],$F=this.elements[15];var $10=other.elements[0],$11=other.elements[1],$12=other.elements[2],$13=other.elements[3];var $14=other.elements[4],$15=other.elements[5],$16=other.elements[6],$17=other.elements[7];var $18=other.elements[8],$19=other.elements[9],$1A=other.elements[10],$1B=other.elements[11];var $1C=other.elements[12],$1D=other.elements[13],$1E=other.elements[14],$1F=other.elements[15];this.elements[0]=$0*$10+$1*$14+$2*$18+$3*$1C;this.elements[1]=$0*$11+$1*$15+$2*$19+$3*$1D;this.elements[2]=$0*$12+$1*$16+$2*$1A+$3*$1E;this.elements[3]=$0*$13+$1*$17+$2*$1B+$3*$1F;this.elements[4]=$4*$10+$5*$14+$6*$18+$7*$1C;this.elements[5]=$4*$11+$5*$15+$6*$19+$7*$1D;this.elements[6]=$4*$12+$5*$16+$6*$1A+$7*$1E;this.elements[7]=$4*$13+$5*$17+$6*$1B+$7*$1F;this.elements[8]=$8*$10+$9*$14+$A*$18+$B*$1C;this.elements[9]=$8*$11+$9*$15+$A*$19+$B*$1D;this.elements[10]=$8*$12+$9*$16+$A*$1A+$B*$1E;this.elements[11]=$8*$13+$9*$17+$A*$1B+$B*$1F;this.elements[12]=$C*$10+$D*$14+$E*$18+$F*$1C;this.elements[13]=$C*$11+$D*$15+$E*$19+$F*$1D;this.elements[14]=$C*$12+$D*$16+$E*$1A+$F*$1E;this.elements[15]=$C*$13+$D*$17+$E*$1B+$F*$1F;return this;},multiplyM2:function(other,dest){var $0=this.elements[0],$1=this.elements[1],$2=this.elements[2],$3=this.elements[3];var $4=this.elements[4],$5=this.elements[5],$6=this.elements[6],$7=this.elements[7];var $8=this.elements[8],$9=this.elements[9],$A=this.elements[10],$B=this.elements[11];var $C=this.elements[12],$D=this.elements[13],$E=this.elements[14],$F=this.elements[15];var $10=other.elements[0],$11=other.elements[1],$12=other.elements[2],$13=other.elements[3];var $14=other.elements[4],$15=other.elements[5],$16=other.elements[6],$17=other.elements[7];var $18=other.elements[8],$19=other.elements[9],$1A=other.elements[10],$1B=other.elements[11];var $1C=other.elements[12],$1D=other.elements[13],$1E=other.elements[14],$1F=other.elements[15];dest.elements[0]=$10*$0+$11*$4+$12*$8+$13*$C;dest.elements[1]=$10*$1+$11*$5+$12*$9+$13*$D;dest.elements[2]=$10*$2+$11*$6+$12*$A+$13*$E;dest.elements[3]=$10*$3+$11*$7+$12*$B+$13*$F;dest.elements[4]=$14*$0+$15*$4+$16*$8+$17*$C;dest.elements[5]=$14*$1+$15*$5+$16*$9+$17*$D;dest.elements[6]=$14*$2+$15*$6+$16*$A+$17*$E;dest.elements[7]=$14*$3+$15*$7+$16*$B+$17*$F;dest.elements[8]=$18*$0+$19*$4+$1A*$8+$1B*$C;dest.elements[9]=$18*$1+$19*$5+$1A*$9+$1B*$D;dest.elements[10]=$18*$2+$19*$6+$1A*$A+$1B*$E;dest.elements[11]=$18*$3+$19*$7+$1A*$B+$1B*$F;dest.elements[12]=$1C*$0+$1D*$4+$1E*$8+$1F*$C;dest.elements[13]=$1C*$1+$1D*$5+$1E*$9+$1F*$D;dest.elements[14]=$1C*$2+$1D*$6+$1E*$A+$1F*$E;dest.elements[15]=$1C*$3+$1D*$7+$1E*$B+$1F*$F;return this;},transformV:function(vect){var $0=vect.elements[0],$1=vect.elements[1],$2=vect.elements[2];vect.elements[0]=this.elements[0]*$0+this.elements[4]*$1+this.elements[8]*$2+this.elements[12];vect.elements[1]=this.elements[1]*$0+this.elements[5]*$1+this.elements[9]*$2+this.elements[13];vect.elements[2]=this.elements[2]*$0+this.elements[6]*$1+this.elements[10]*$2+this.elements[14];return vect;},multiplyAffineM:function(other){var $0=GLSharp.Core.SystemCore.environment.createFloat32Array(16);$0[0]=this.elements[0]*other.elements[0]+this.elements[4]*other.elements[1]+this.elements[8]*other.elements[2];$0[1]=this.elements[1]*other.elements[0]+this.elements[5]*other.elements[1]+this.elements[9]*other.elements[2];$0[2]=this.elements[2]*other.elements[0]+this.elements[6]*other.elements[1]+this.elements[10]*other.elements[2];$0[3]=0;$0[4]=this.elements[0]*other.elements[4]+this.elements[4]*other.elements[5]+this.elements[8]*other.elements[6];$0[5]=this.elements[1]*other.elements[4]+this.elements[5]*other.elements[5]+this.elements[9]*other.elements[6];$0[6]=this.elements[2]*other.elements[4]+this.elements[6]*other.elements[5]+this.elements[10]*other.elements[6];$0[7]=0;$0[8]=this.elements[0]*other.elements[8]+this.elements[4]*other.elements[9]+this.elements[8]*other.elements[10];$0[9]=this.elements[1]*other.elements[8]+this.elements[5]*other.elements[9]+this.elements[9]*other.elements[10];$0[10]=this.elements[2]*other.elements[8]+this.elements[6]*other.elements[9]+this.elements[10]*other.elements[10];$0[11]=0;$0[12]=this.elements[0]*other.elements[12]+this.elements[4]*other.elements[13]+this.elements[8]*other.elements[14]+this.elements[12];$0[13]=this.elements[1]*other.elements[12]+this.elements[5]*other.elements[13]+this.elements[9]*other.elements[14]+this.elements[13];$0[14]=this.elements[2]*other.elements[12]+this.elements[6]*other.elements[13]+this.elements[10]*other.elements[14]+this.elements[14];$0[15]=1;this.elements=$0;return this;},rotate:function(angle,axis){var $0=axis.elements[0],$1=axis.elements[1],$2=axis.elements[2];var $3=Math.sqrt($0*$0+$1*$1+$2*$2);if($3!==1){$3=1/$3;$0*=$3;$1*=$3;$2*=$3;}var $4=Math.sin(angle);var $5=Math.cos(angle);var $6=1-$5;var $7=this.elements[0],$8=this.elements[1],$9=this.elements[2],$A=this.elements[3];var $B=this.elements[4],$C=this.elements[5],$D=this.elements[6],$E=this.elements[7];var $F=this.elements[8],$10=this.elements[9],$11=this.elements[10],$12=this.elements[11];var $13=$0*$0*$6+$5,$14=$1*$0*$6+$2*$4,$15=$2*$0*$6-$1*$4;var $16=$0*$1*$6-$2*$4,$17=$1*$1*$6+$5,$18=$2*$1*$6+$0*$4;var $19=$0*$2*$6+$1*$4,$1A=$1*$2*$6-$0*$4,$1B=$2*$2*$6+$5;this.elements[0]=$7*$13+$B*$14+$F*$15;this.elements[1]=$8*$13+$C*$14+$10*$15;this.elements[2]=$9*$13+$D*$14+$11*$15;this.elements[3]=$A*$13+$E*$14+$12*$15;this.elements[4]=$7*$16+$B*$17+$F*$18;this.elements[5]=$8*$16+$C*$17+$10*$18;this.elements[6]=$9*$16+$D*$17+$11*$18;this.elements[7]=$A*$16+$E*$17+$12*$18;this.elements[8]=$7*$19+$B*$1A+$F*$1B;this.elements[9]=$8*$19+$C*$1A+$10*$1B;this.elements[10]=$9*$19+$D*$1A+$11*$1B;this.elements[11]=$A*$19+$E*$1A+$12*$1B;return this;},rotateX:function(angle){var $0=Math.sin(angle);var $1=Math.cos(angle);var $2=this.elements[4],$3=this.elements[5],$4=this.elements[6],$5=this.elements[7];var $6=this.elements[8],$7=this.elements[9],$8=this.elements[10],$9=this.elements[11];this.elements[4]=$2*$1+$6*$0;this.elements[5]=$3*$1+$7*$0;this.elements[6]=$4*$1+$8*$0;this.elements[7]=$5*$1+$9*$0;this.elements[8]=$2*-$0+$6*$1;this.elements[9]=$3*-$0+$7*$1;this.elements[10]=$4*-$0+$8*$1;this.elements[11]=$5*-$0+$9*$1;return this;},rotateY:function(angle){var $0=Math.sin(angle);var $1=Math.cos(angle);var $2=this.elements[0],$3=this.elements[1],$4=this.elements[2],$5=this.elements[3];var $6=this.elements[8],$7=this.elements[9],$8=this.elements[10],$9=this.elements[11];this.elements[0]=$2*$1+$6*-$0;this.elements[1]=$3*$1+$7*-$0;this.elements[2]=$4*$1+$8*-$0;this.elements[3]=$5*$1+$9*-$0;this.elements[8]=$2*$0+$6*$1;this.elements[9]=$3*$0+$7*$1;this.elements[10]=$4*$0+$8*$1;this.elements[11]=$5*$0+$9*$1;return this;},rotateZ:function(angle){var $0=Math.sin(angle);var $1=Math.cos(angle);var $2=this.elements[0],$3=this.elements[1],$4=this.elements[2],$5=this.elements[3];var $6=this.elements[4],$7=this.elements[5],$8=this.elements[6],$9=this.elements[7];this.elements[0]=$2*$1+$6*$0;this.elements[1]=$3*$1+$7*$0;this.elements[2]=$4*$1+$8*$0;this.elements[3]=$5*$1+$9*$0;this.elements[4]=$2*-$0+$6*$1;this.elements[5]=$3*-$0+$7*$1;this.elements[6]=$4*-$0+$8*$1;this.elements[7]=$5*-$0+$9*$1;return this;},setRotation3:function(x,y,z){var $0=Math.sin(x);var $1=Math.cos(x);var $2=Math.sin(y);var $3=Math.cos(y);var $4=Math.sin(z);var $5=Math.cos(z);this.elements[0]=$5*$3;this.elements[1]=$4*$3;this.elements[2]=-$2;this.elements[3]=0;this.elements[4]=-$4*$1+$5*$2*$0;this.elements[5]=$5*$1+$4*$2*$0;this.elements[6]=$3*$0;this.elements[7]=0;this.elements[8]=$4*$0+$5*$2*$1;this.elements[9]=$5*(-$0)+$4*$2*$0;this.elements[10]=$3*$1;this.elements[11]=0;this.elements[12]=0;this.elements[13]=0;this.elements[14]=0;this.elements[15]=1;return this;},setRotation:function(rotation){var $0=rotation.elements[0];var $1=rotation.elements[1];var $2=rotation.elements[2];var $3=Math.sin($0);var $4=Math.cos($0);var $5=Math.sin($1);var $6=Math.cos($1);var $7=Math.sin($2);var $8=Math.cos($2);this.elements[0]=$8*$6;this.elements[1]=$7*$6;this.elements[2]=-$5;this.elements[3]=0;this.elements[4]=-$7*$4+$8*$5*$3;this.elements[5]=$8*$4+$7*$5*$3;this.elements[6]=$6*$3;this.elements[7]=0;this.elements[8]=$7*$3+$8*$5*$4;this.elements[9]=$8*(-$3)+$7*$5*$3;this.elements[10]=$6*$4;this.elements[11]=0;this.elements[12]=0;this.elements[13]=0;this.elements[14]=0;this.elements[15]=1;return this;},scale:function(scale){this.elements[0]*=scale.elements[0];this.elements[1]*=scale.elements[0];this.elements[2]*=scale.elements[0];this.elements[3]*=scale.elements[0];this.elements[4]*=scale.elements[1];this.elements[5]*=scale.elements[1];this.elements[6]*=scale.elements[1];this.elements[7]*=scale.elements[1];this.elements[8]*=scale.elements[2];this.elements[9]*=scale.elements[2];this.elements[10]*=scale.elements[2];this.elements[11]*=scale.elements[2];return this;},scale1:function(value){this.elements[0]*=value;this.elements[1]*=value;this.elements[2]*=value;this.elements[3]*=value;this.elements[4]*=value;this.elements[5]*=value;this.elements[6]*=value;this.elements[7]*=value;this.elements[8]*=value;this.elements[9]*=value;this.elements[10]*=value;this.elements[11]*=value;return this;},setScale1:function(value){this.elements[0]=value;this.elements[5]=value;this.elements[10]=value;return this;},setScale3:function(x,y,z){this.elements[0]=x;this.elements[5]=y;this.elements[10]=z;return this;},translate:function(distance){var $0=distance.elements[0],$1=distance.elements[1],$2=distance.elements[2];this.elements[12]=this.elements[0]*$0+this.elements[4]*$1+this.elements[8]*$2+this.elements[12];this.elements[13]=this.elements[1]*$0+this.elements[5]*$1+this.elements[9]*$2+this.elements[13];this.elements[14]=this.elements[2]*$0+this.elements[6]*$1+this.elements[10]*$2+this.elements[14];this.elements[15]=this.elements[3]*$0+this.elements[7]*$1+this.elements[11]*$2+this.elements[15];return this;},translate3:function(x,y,z){this.elements[12]=this.elements[0]*x+this.elements[4]*y+this.elements[8]*z+this.elements[12];this.elements[13]=this.elements[1]*x+this.elements[5]*y+this.elements[9]*z+this.elements[13];this.elements[14]=this.elements[2]*x+this.elements[6]*y+this.elements[10]*z+this.elements[14];this.elements[15]=this.elements[3]*x+this.elements[7]*y+this.elements[11]*z+this.elements[15];return this;},setTranslate:function(position){this.elements[12]=position.elements[0];this.elements[13]=position.elements[1];this.elements[14]=position.elements[2];return this;},setTranslate3:function(x,y,z){this.elements[12]=x;this.elements[13]=y;this.elements[14]=z;return this;},translateInverse:function(distance){var $0=-distance.elements[0],$1=-distance.elements[1],$2=-distance.elements[2];this.elements[12]=this.elements[0]*$0+this.elements[4]*$1+this.elements[8]*$2+this.elements[12];this.elements[13]=this.elements[1]*$0+this.elements[5]*$1+this.elements[9]*$2+this.elements[13];this.elements[14]=this.elements[2]*$0+this.elements[6]*$1+this.elements[10]*$2+this.elements[14];this.elements[15]=this.elements[3]*$0+this.elements[7]*$1+this.elements[11]*$2+this.elements[15];return this;},transpose:function(){var $0=this.elements[1],$1=this.elements[2],$2=this.elements[3];var $3=this.elements[6],$4=this.elements[7];var $5=this.elements[11];this.elements[1]=this.elements[4];this.elements[2]=this.elements[8];this.elements[3]=this.elements[12];this.elements[4]=$0;this.elements[6]=this.elements[9];this.elements[7]=this.elements[13];this.elements[8]=$1;this.elements[9]=$3;this.elements[11]=this.elements[14];this.elements[12]=$2;this.elements[13]=$4;this.elements[14]=$5;return this;},clone:function(){return new GLSharp.Util.Matrix4X4(this.elements);},inverse:function(){var $0=this.elements[0],$1=this.elements[1],$2=this.elements[2],$3=this.elements[3];var $4=this.elements[4],$5=this.elements[5],$6=this.elements[6],$7=this.elements[7];var $8=this.elements[8],$9=this.elements[9],$A=this.elements[10],$B=this.elements[11];var $C=this.elements[12],$D=this.elements[13],$E=this.elements[14],$F=this.elements[15];var $10=$0*$5-$1*$4;var $11=$0*$6-$2*$4;var $12=$0*$7-$3*$4;var $13=$1*$6-$2*$5;var $14=$1*$7-$3*$5;var $15=$2*$7-$3*$6;var $16=$8*$D-$9*$C;var $17=$8*$E-$A*$C;var $18=$8*$F-$B*$C;var $19=$9*$E-$A*$D;var $1A=$9*$F-$B*$D;var $1B=$A*$F-$B*$E;var $1C=1/($10*$1B-$11*$1A+$12*$19+$13*$18-$14*$17+$15*$16);this.elements[0]=($5*$1B-$6*$1A+$7*$19)*$1C;this.elements[1]=(-$1*$1B+$2*$1A-$3*$19)*$1C;this.elements[2]=($D*$15-$E*$14+$F*$13)*$1C;this.elements[3]=(-$9*$15+$A*$14-$B*$13)*$1C;this.elements[4]=(-$4*$1B+$6*$18-$7*$17)*$1C;this.elements[5]=($0*$1B-$2*$18+$3*$17)*$1C;this.elements[6]=(-$C*$15+$E*$12-$F*$11)*$1C;this.elements[7]=($8*$15-$A*$12+$B*$11)*$1C;this.elements[8]=($4*$1A-$5*$18+$7*$16)*$1C;this.elements[9]=(-$0*$1A+$1*$18-$3*$16)*$1C;this.elements[10]=($C*$14-$D*$12+$F*$10)*$1C;this.elements[11]=(-$8*$14+$9*$12-$B*$10)*$1C;this.elements[12]=(-$4*$19+$5*$17-$6*$16)*$1C;this.elements[13]=($0*$19-$1*$17+$2*$16)*$1C;this.elements[14]=(-$C*$13+$D*$11-$E*$10)*$1C;this.elements[15]=($8*$13-$9*$11+$A*$10)*$1C;return this;},inverse2:function(dest){var $0=this.elements[0],$1=this.elements[1],$2=this.elements[2],$3=this.elements[3];var $4=this.elements[4],$5=this.elements[5],$6=this.elements[6],$7=this.elements[7];var $8=this.elements[8],$9=this.elements[9],$A=this.elements[10],$B=this.elements[11];var $C=this.elements[12],$D=this.elements[13],$E=this.elements[14],$F=this.elements[15];var $10=$0*$5-$1*$4;var $11=$0*$6-$2*$4;var $12=$0*$7-$3*$4;var $13=$1*$6-$2*$5;var $14=$1*$7-$3*$5;var $15=$2*$7-$3*$6;var $16=$8*$D-$9*$C;var $17=$8*$E-$A*$C;var $18=$8*$F-$B*$C;var $19=$9*$E-$A*$D;var $1A=$9*$F-$B*$D;var $1B=$A*$F-$B*$E;var $1C=1/($10*$1B-$11*$1A+$12*$19+$13*$18-$14*$17+$15*$16);dest.elements[0]=($5*$1B-$6*$1A+$7*$19)*$1C;dest.elements[1]=(-$1*$1B+$2*$1A-$3*$19)*$1C;dest.elements[2]=($D*$15-$E*$14+$F*$13)*$1C;dest.elements[3]=(-$9*$15+$A*$14-$B*$13)*$1C;dest.elements[4]=(-$4*$1B+$6*$18-$7*$17)*$1C;dest.elements[5]=($0*$1B-$2*$18+$3*$17)*$1C;dest.elements[6]=(-$C*$15+$E*$12-$F*$11)*$1C;dest.elements[7]=($8*$15-$A*$12+$B*$11)*$1C;dest.elements[8]=($4*$1A-$5*$18+$7*$16)*$1C;dest.elements[9]=(-$0*$1A+$1*$18-$3*$16)*$1C;dest.elements[10]=($C*$14-$D*$12+$F*$10)*$1C;dest.elements[11]=(-$8*$14+$9*$12-$B*$10)*$1C;dest.elements[12]=(-$4*$19+$5*$17-$6*$16)*$1C;dest.elements[13]=($0*$19-$1*$17+$2*$16)*$1C;dest.elements[14]=(-$C*$13+$D*$11-$E*$10)*$1C;dest.elements[15]=($8*$13-$9*$11+$A*$10)*$1C;return this;},copy:function(other){other.elements[0]=this.elements[0];other.elements[1]=this.elements[1];other.elements[2]=this.elements[2];other.elements[3]=this.elements[3];other.elements[4]=this.elements[4];other.elements[5]=this.elements[5];other.elements[6]=this.elements[6];other.elements[7]=this.elements[7];other.elements[8]=this.elements[8];other.elements[9]=this.elements[9];other.elements[10]=this.elements[10];other.elements[11]=this.elements[11];other.elements[12]=this.elements[12];other.elements[13]=this.elements[13];other.elements[14]=this.elements[14];other.elements[15]=this.elements[15];}}
GLSharp.Util.Quaternion4x4=function(elements){this.elements=(elements==null)?GLSharp.Core.SystemCore.environment.createFloat32Array(4):GLSharp.Core.SystemCore.environment.createFloat32ArrayFromArray(elements);}
GLSharp.Util.Quaternion4x4.prototype={elements:null,inverse:function(){this.elements[0]*=-1;this.elements[1]*=-1;this.elements[2]*=-1;return this;},multiplyQ:function(other){var $0=this.elements[0],$1=this.elements[1],$2=this.elements[2],$3=this.elements[3];var $4=other.elements[0],$5=other.elements[1],$6=other.elements[2],$7=other.elements[3];this.elements[0]=$0*$7+$3*$4+$1*$6-$2*$5;this.elements[1]=$1*$7+$3*$5+$2*$4-$0*$6;this.elements[2]=$2*$7+$3*$6+$0*$5-$1*$4;this.elements[3]=$3*$7-$0*$4-$1*$5-$2*$6;return this;},multiplyV:function(other){var $0=other.elements[0],$1=other.elements[1],$2=other.elements[2];var $3=this.elements[0],$4=this.elements[1],$5=this.elements[2],$6=this.elements[3];var $7=$6*$0+$4*$2-$5*$1;var $8=$6*$1+$5*$0-$3*$2;var $9=$6*$2+$3*$1-$4*$0;var $A=-$3*$0-$4*$1-$5*$2;other.elements[0]=$7*$6+$A*-$3+$8*-$5-$9*-$4;other.elements[1]=$8*$6+$A*-$4+$9*-$3-$7*-$5;other.elements[2]=$9*$6+$A*-$5+$7*-$4-$8*-$3;return other;},toMat4x4:function(){var $0=new GLSharp.Util.Matrix4X4(null);var $1=this.elements[0],$2=this.elements[1],$3=this.elements[2],$4=this.elements[3];var $5=$1+$1;var $6=$2+$2;var $7=$3+$3;var $8=$1*$5;var $9=$1*$6;var $A=$1*$7;var $B=$2*$6;var $C=$2*$7;var $D=$3*$7;var $E=$4*$5;var $F=$4*$6;var $10=$4*$7;$0.elements[0]=1-($B+$D);$0.elements[1]=$9-$10;$0.elements[2]=$A+$F;$0.elements[3]=0;$0.elements[4]=$9+$10;$0.elements[5]=1-($8+$D);$0.elements[6]=$C-$E;$0.elements[7]=0;$0.elements[8]=$A-$F;$0.elements[9]=$C+$E;$0.elements[10]=1-($8+$B);$0.elements[11]=0;$0.elements[12]=0;$0.elements[13]=0;$0.elements[14]=0;$0.elements[15]=1;return $0;},clone:function(){return new GLSharp.Util.Quaternion4x4(this.elements);}}
GLSharp.Util.VertexBoundingVolume=function(){}
GLSharp.Util.VertexBoundingVolume.prototype={center:null,vertexIndex:0}
GLSharp.Util.Vector3=function(elements){this.elements=(elements==null)?GLSharp.Core.SystemCore.environment.createFloat32Array(3):GLSharp.Core.SystemCore.environment.createFloat32ArrayFromArray(elements);}
GLSharp.Util.Vector3.build=function(other){return new GLSharp.Util.Vector3(other.elements);}
GLSharp.Util.Vector3.build3=function(x,y,z){var $0=new GLSharp.Util.Vector3(null);$0.elements[0]=x;$0.elements[1]=y;$0.elements[1]=z;return $0;}
GLSharp.Util.Vector3.prototype={elements:null,set:function(other){this.elements[0]=other.elements[0];this.elements[1]=other.elements[1];this.elements[2]=other.elements[2];},set3:function(x,y,z){this.elements[0]=x;this.elements[1]=y;this.elements[2]=z;},add:function(other){this.elements[0]+=other.elements[0];this.elements[1]+=other.elements[1];this.elements[2]+=other.elements[2];return this;},add3:function(x,y,z){this.elements[0]+=x;this.elements[1]+=y;this.elements[2]+=z;return this;},subtract:function(other){this.elements[0]-=other.elements[0];this.elements[1]-=other.elements[1];this.elements[2]-=other.elements[2];return this;},subtract3:function(x,y,z){this.elements[0]-=x;this.elements[1]-=y;this.elements[2]-=z;return this;},direction:function(to){return this.clone().subtract(to).normalize();},distance:function(other){return Math.sqrt((other.elements[0]-this.elements[0])*(other.elements[0]-this.elements[0])+(other.elements[1]-this.elements[1])*(other.elements[1]-this.elements[1])+(other.elements[2]-this.elements[2])*(other.elements[2]-this.elements[2]));},distance3:function(x,y,z){return Math.sqrt((x-this.elements[0])*(x-this.elements[0])+(y-this.elements[1])*(y-this.elements[1])+(z-this.elements[2])*(z-this.elements[2]));},length:function(){return Math.sqrt(this.elements[0]*this.elements[0]+this.elements[1]*this.elements[1]+this.elements[2]*this.elements[2]);},normalize:function(){var $0=1/this.length();this.elements[0]*=$0;this.elements[1]*=$0;this.elements[2]*=$0;return this;},scale:function(val){this.elements[0]*=val;this.elements[1]*=val;this.elements[2]*=val;return this;},dot:function(other){return this.elements[0]*other.elements[0]+this.elements[1]*other.elements[1]+this.elements[2]*other.elements[2];},cross:function(other){var $0=this.elements[0],$1=this.elements[1],$2=this.elements[2];var $3=other.elements[0],$4=other.elements[1],$5=other.elements[2];this.elements[0]=$1*$5-$2*$4;this.elements[1]=$2*$3-$0*$5;this.elements[2]=$0*$4-$1*$3;return this;},multScalar:function(scalar){this.elements[0]*=scalar;this.elements[1]*=scalar;this.elements[2]*=scalar;},multVect:function(other){this.elements[0]*=other.elements[0];this.elements[1]*=other.elements[1];this.elements[2]*=other.elements[2];},clone:function(){return new GLSharp.Util.Vector3(this.elements);}}
Type.registerNamespace('GLSharp');GLSharp.Engine=function(){this.$3=Date.get_now().getTime();this.$6=[];this.$7=[];}
GLSharp.Engine.prototype={$0:null,$1:null,$2:null,$4:0,$5:0,$8:null,$9:null,get_activeGame:function(){return this.$9;},set_activeGame:function(value){this.$9=value;this.$9.set_engine(this);return value;},$A:null,get_world:function(){return this.$A;},set_world:function(value){this.$A=value;this.$11(this.$A);return value;},$B:null,get_graphics:function(){return this.$B;},set_graphics:function(value){this.$B=value;return value;},$C:null,get_library:function(){return this.$C;},set_library:function(value){this.$C=value;return value;},run:function(){if(this.get_activeGame()==null){throw new Error('No active game defined.');}var $0=this;GLSharp.Core.SystemCore.timer.requestAnimationFrame(function(){
$0.get_graphics().render();});this.$1=GLSharp.Core.SystemCore.timer.start(function(){
$0.get_library().update();},60000,true);this.$2=GLSharp.Core.SystemCore.timer.start(function(){
$0.$D();},1000/24,true);this.get_graphics().initialize(45,0.1,200);this.get_graphics().set_viewOccluder(new GLSharp.Graphics.ViewFrustrumOccluder());this.get_activeGame().initialize();this.$8=new Box2D.Dynamics.b2World(new Box2D.Common.Math.b2Vec2(0,0),true);},$D:function(){var $0=Date.get_now().getTime();var $1=(($0-this.$3))/1000;this.$10($1);this.$F($1);this.$E($1);this.$3=$0;},$E:function($p0){this.$8.Step($p0,10,10);},$F:function($p0){var $0=this;this.$4+=$p0;this.$5=Math.floor(this.$4/0.015);this.$4-=this.$5*0.015;this.$6.forEach(ss.Delegate.create(this,function($p1_0){
if($p1_0.animation!=null){$p1_0.animation.currentFrame+=this.$5;if($p1_0.animation.currentFrame>=$p1_0.animation.animationEnd){if($p1_0.animation.loop){$p1_0.animation.currentFrame=$p1_0.animation.animationStart;}else{$p1_0.animation.currentFrame=$p1_0.animation.animationEnd-1;return;}}$p1_0.invalidateWorldTransformation();}}));},$10:function($p0){var $0=this;this.$7.forEach(function($p1_0){
if($p1_0.controller!=null){$p1_0.controller.update($p0);}});},$11:function($p0){$p0.nodeAdded.subscribe(ss.Delegate.create(this,this.$13),true);$p0.nodeRemoved.subscribe(ss.Delegate.create(this,this.$12),true);var $0=this;$p0.get_rootNodes().forEach(function($p1_0){
$0.$13($0,$p1_0);});},$12:function($p0,$p1){var $0=$p1;var $1=this;$0.childrenList.forEach(function($p1_0){
$1.$12($1,$p1_0);});if($0.animation!=null){this.$6.remove($0);}if($0.controller!=null){this.$7.remove($0);}if($0.get_components()['collision']!=null){this.$15($0);}$0.childAdded.unsubscribe(ss.Delegate.create(this,this.$13));},$13:function($p0,$p1){var $0=$p1;var $1=this;$0.childrenList.forEach(function($p1_0){
$1.$13($1,$p1_0);});if($0.animation!=null){this.$6.add($0);}if($0.controller!=null){this.$7.add($0);}if($0.get_components()['collision']!=null){this.$14($0);}$0.childAdded.subscribe(ss.Delegate.create(this,this.$13),true);},$14:function($p0){var $0=$p0.get_components()['collision'];if($0.body!=null){this.$15($p0);}$0.body=this.$8.CreateBody($0.bodyDefinition);$0.body.CreateFixture($0.fixtureDefinition);},$15:function($p0){var $0=$p0.get_components()['collision'];if($0.body==null){return;}this.$8.DestroyBody($0.body);},$16:function(){GLSharp.Core.SystemCore.logger.log('warning : debug is enabled.');}}
Type.registerNamespace('GLSharp.Game');GLSharp.Game.GameBase=function(){}
GLSharp.Game.GameBase.prototype={$0:null,get_engine:function(){return this.$0;},set_engine:function(value){this.$0=value;return value;},initialize:function(){this.startup();}}
GLSharp.Content.ResourceItem.registerClass('GLSharp.Content.ResourceItem');GLSharp.Content.LightItem.registerClass('GLSharp.Content.LightItem',GLSharp.Content.ResourceItem);GLSharp.Content.LightConverter.registerClass('GLSharp.Content.LightConverter',null,GLSharp.Content.IResourceConverter);GLSharp.Content.PropertyItem.registerClass('GLSharp.Content.PropertyItem');GLSharp.Content.MaterialItem.registerClass('GLSharp.Content.MaterialItem',GLSharp.Content.ResourceItem);GLSharp.Content.MaterialConverter.registerClass('GLSharp.Content.MaterialConverter',null,GLSharp.Content.IResourceConverter);GLSharp.Content.TextureItem.registerClass('GLSharp.Content.TextureItem',GLSharp.Content.ResourceItem);GLSharp.Content.TextureConverter.registerClass('GLSharp.Content.TextureConverter',null,GLSharp.Content.IResourceConverter);GLSharp.Content.MeshItem.registerClass('GLSharp.Content.MeshItem',GLSharp.Content.ResourceItem);GLSharp.Content.MeshConverter.registerClass('GLSharp.Content.MeshConverter',null,GLSharp.Content.IResourceConverter);GLSharp.Content.NodeItem.registerClass('GLSharp.Content.NodeItem',GLSharp.Content.ResourceItem);GLSharp.Content.NodeConverter.registerClass('GLSharp.Content.NodeConverter',null,GLSharp.Content.IResourceConverter);GLSharp.Content.Handle.registerClass('GLSharp.Content.Handle');GLSharp.Content.ResourceCollection.registerClass('GLSharp.Content.ResourceCollection');GLSharp.Content.LibraryResult.registerClass('GLSharp.Content.LibraryResult');GLSharp.Content.Library.registerClass('GLSharp.Content.Library');GLSharp.Graphics.CullInfo.registerClass('GLSharp.Graphics.CullInfo');GLSharp.Graphics.RegionOccluder.registerClass('GLSharp.Graphics.RegionOccluder',null,GLSharp.Graphics.IViewOccluder);GLSharp.Graphics.ViewFrustrumOccluder.registerClass('GLSharp.Graphics.ViewFrustrumOccluder',null,GLSharp.Graphics.IViewOccluder);GLSharp.Graphics.ShaderGroup.registerClass('GLSharp.Graphics.ShaderGroup');GLSharp.Graphics.CompiledShader.registerClass('GLSharp.Graphics.CompiledShader');GLSharp.Graphics.Color.registerClass('GLSharp.Graphics.Color');GLSharp.Graphics.Core.RenderGroup.registerClass('GLSharp.Graphics.Core.RenderGroup');GLSharp.Graphics.Effects.BloomEffect.registerClass('GLSharp.Graphics.Effects.BloomEffect',null,GLSharp.Graphics.Effects.IPostProcessEffect);GLSharp.Graphics.Effects.DepthEffect.registerClass('GLSharp.Graphics.Effects.DepthEffect',null,GLSharp.Graphics.Effects.IPostProcessEffect);GLSharp.Graphics.Effects.MotionBlurEffect.registerClass('GLSharp.Graphics.Effects.MotionBlurEffect',null,GLSharp.Graphics.Effects.IPostProcessEffect);GLSharp.Graphics.Effects.SsaoEffect.registerClass('GLSharp.Graphics.Effects.SsaoEffect',null,GLSharp.Graphics.Effects.IPostProcessEffect);GLSharp.Universe.Component.registerClass('GLSharp.Universe.Component');GLSharp.Universe.CameraComponent.registerClass('GLSharp.Universe.CameraComponent',GLSharp.Universe.Component);GLSharp.Universe.CollisionComponent.registerClass('GLSharp.Universe.CollisionComponent',GLSharp.Universe.Component);GLSharp.Universe.ControllerBase.registerClass('GLSharp.Universe.ControllerBase');GLSharp.Universe.LightComponent.registerClass('GLSharp.Universe.LightComponent',GLSharp.Universe.Component);GLSharp.Universe.MaterialComponent.registerClass('GLSharp.Universe.MaterialComponent',GLSharp.Universe.Component);GLSharp.Universe.ComponentCollection.registerClass('GLSharp.Universe.ComponentCollection');GLSharp.Universe.MeshComponent.registerClass('GLSharp.Universe.MeshComponent',GLSharp.Universe.Component);GLSharp.Universe.NodeAnimation.registerClass('GLSharp.Universe.NodeAnimation');GLSharp.Universe.NodeAnimationGroup.registerClass('GLSharp.Universe.NodeAnimationGroup');GLSharp.Universe.Node.registerClass('GLSharp.Universe.Node');GLSharp.Universe.World.registerClass('GLSharp.Universe.World');GLSharp.Util.Matrix4X4.registerClass('GLSharp.Util.Matrix4X4');GLSharp.Util.Quaternion4x4.registerClass('GLSharp.Util.Quaternion4x4');GLSharp.Util.VertexBoundingVolume.registerClass('GLSharp.Util.VertexBoundingVolume');GLSharp.Util.Vector3.registerClass('GLSharp.Util.Vector3');GLSharp.Engine.registerClass('GLSharp.Engine');GLSharp.Game.GameBase.registerClass('GLSharp.Game.GameBase');GLSharp.Content.MaterialConverter.colorType='color';GLSharp.Content.MaterialConverter.textureHandleType='texture';GLSharp.Content.MaterialConverter.floatType='float';GLSharp.Content.ResourceItem.$0=0;GLSharp.Universe.LightComponent.typePoint=1;GLSharp.Universe.Component.$0=0;GLSharp.Universe.Component.meshComponent='mesh';GLSharp.Universe.Component.materialComponent='material';GLSharp.Universe.Component.textureComponent='texture';GLSharp.Universe.Component.cameraComponent='camera';GLSharp.Universe.Component.lightComponent='light';GLSharp.Universe.Component.collisionComponent='collision';GLSharp.Util.Matrix4X4.$0=null;})();// This script was generated using Script# v0.7.4.0
