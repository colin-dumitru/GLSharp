// DemoGame.js
(function(){
Type.registerNamespace('GLSharp');GLSharp.Demo=function(){GLSharp.Demo.initializeBase(this);}
GLSharp.Demo.prototype={$1_0:null,$1_1:null,$1_2:null,$1_3:null,$1_4:null,$1_5:null,startup:function(){var $0=this;this.get_engine().get_library().loadLibrary('/Data/JSON/mech.json').finished.subscribe(ss.Delegate.create(this,this.$1_6),false);this.get_engine().get_library().loadLibrary('/Data/JSON/scene.json').finished.subscribe(ss.Delegate.create(this,this.$1_7),false);this.$1_0=GLSharp.Core.SystemCore.timer.start(function(){
$0.$1_8();},1000/20,true);this.get_engine().get_graphics().set_viewOccluder(new GLSharp.Graphics.RegionOccluder(25,20));this.get_engine().get_graphics().queuePostProcess(this.$1_4=new GLSharp.Graphics.Effects.BloomEffect());this.get_engine().get_graphics().queuePostProcess(this.$1_5=new GLSharp.Graphics.Effects.SsaoEffect());this.get_engine().get_graphics().queuePostProcess(this.$1_2=new GLSharp.Graphics.Effects.DepthEffect());this.get_engine().get_graphics().queuePostProcess(this.$1_3=new GLSharp.Graphics.Effects.MotionBlurEffect());},$1_6:function($p0,$p1){var $0=(this.get_engine().get_library().getResource(GLSharp.Content.Handle.create('mech','mech'))).root;$0.bindController(this.$1_1=new GLSharp.DemoGame.Controllers.PlayerController());this.get_engine().get_world().addRootNode($0);this.get_engine().get_graphics().get_camera().bindController(new GLSharp.DemoGame.Controllers.CameraController(this.$1_1));this.get_engine().get_world().addRootNode(this.get_engine().get_graphics().get_camera());},$1_7:function($p0,$p1){var $0=(this.get_engine().get_library().getResource(GLSharp.Content.Handle.create('scen','root_scene'))).root;this.get_engine().get_world().addRootNode($0);},$1_8:function(){}}
Type.registerNamespace('GLSharp.DemoGame.Controllers');GLSharp.DemoGame.Controllers.CameraController=function(player){GLSharp.DemoGame.Controllers.CameraController.initializeBase(this);this.$1_1=player;}
GLSharp.DemoGame.Controllers.CameraController.prototype={$1_0:null,$1_1:null,bindParent:function(){this.$1_0=this.parent;this.$1_0.translate3(0,30,17);this.$1_0.rotateX(-1);},update:function(delta){this.$1_2();},$1_2:function(){this.$1_0.translate3(-(this.$1_0.localTranslation.elements[0]-this.$1_1.parent.localTranslation.elements[0]),0,-(this.$1_0.localTranslation.elements[2]-17-this.$1_1.parent.localTranslation.elements[2]));},$1_3:function(){if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.a)){this.$1_0.translate3(-0.5,0,0);}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.d)){this.$1_0.translate3(0.5,0,0);}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.w)){this.$1_0.translate3(0,0,-0.5);}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.s)){this.$1_0.translate3(0,0,0.5);}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.q)){this.$1_0.translate3(0,-0.5,0);}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.e)){this.$1_0.translate3(0,0.5,0);}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.numpad2)){this.$1_0.rotateX(0.1);}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.numpad8)){this.$1_0.rotateX(-0.1);}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.numpad6)){this.$1_0.rotateY(0.1);}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.numpad4)){this.$1_0.rotateY(-0.1);}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.numpad9)){this.$1_0.rotateZ(0.1);}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.numpad7)){this.$1_0.rotateZ(-0.1);}}}
GLSharp.DemoGame.Controllers.MechControllerBase=function(){GLSharp.DemoGame.Controllers.MechControllerBase.initializeBase(this);}
GLSharp.DemoGame.Controllers.PlayerController=function(){this.$1_0=new GLSharp.Universe.NodeAnimationGroup();GLSharp.DemoGame.Controllers.PlayerController.initializeBase(this);this.$1_A=GLSharp.Core.SystemCore.resourceManager.getResource('/Data/Audio/mech_walk.mp3',null).get_data();}
GLSharp.DemoGame.Controllers.PlayerController.prototype={$1_1:null,$1_2:null,$1_3:null,$1_4:null,$1_5:null,$1_6:null,$1_7:null,$1_8:null,$1_9:null,$1_A:null,$1_B:0,$1_C:0,$1_D:0,$1_E:0,$1_F:false,$1_10:false,$1_11:null,bindParent:function(){this.$1_1=this.parent.findChild('mech',true);this.$1_2=this.parent.findChild('head',true);this.$1_3=this.parent.findChild('body',true);this.$1_6=this.$1_3.findChild('ulegl',true);this.$1_7=this.$1_3.findChild('ulegr',true);this.$1_4=this.$1_6.findChild('llegl',true);this.$1_5=this.$1_7.findChild('llegr',true);this.$1_8=this.$1_4.findChild('footl',true);this.$1_9=this.$1_5.findChild('footr',true);this.$1_0.animations.add(this.$1_3.animation);this.$1_0.animations.add(this.$1_6.animation);this.$1_0.animations.add(this.$1_7.animation);this.$1_0.animations.add(this.$1_4.animation);this.$1_0.animations.add(this.$1_5.animation);this.$1_0.animations.add(this.$1_8.animation);this.$1_0.animations.add(this.$1_9.animation);this.$1_0.setRange(0,48,true);var $0=this.$1_1.findChild('__cs_mech',true);this.$1_11=$0.get_components()[GLSharp.Universe.Component.collisionComponent];},update:function(delta){this.$1_12();this.$1_13();},$1_12:function(){var $0=GLSharp.Core.SystemCore.input.get_mouseX();var $1=GLSharp.Core.SystemCore.input.get_mouseY();var $2=Math.atan2($0,$1);this.$1_2.rotateY(-(this.$1_2.localRotation.elements[1]-$2));},$1_13:function(){this.$1_D=0;this.$1_E=0;this.$1_F=false;if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.a)){this.$1_D=-1;this.$1_F=true;}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.d)){this.$1_D=1;this.$1_F=true;}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.w)){this.$1_E=1;this.$1_F=true;}if(GLSharp.Core.SystemCore.input.keySet(GLSharp.Core.Keys.s)){this.$1_E=-1;this.$1_F=true;}var $0=(Math.PI-Math.atan2(this.$1_D,this.$1_E));if(this.$1_F){this.$1_3.rotateY(-(this.$1_3.localRotation.elements[1]-$0));this.$1_11.body.m_linearVelocity.x=Math.sin($0)*10;this.$1_11.body.m_linearVelocity.y=Math.cos($0)*10;this.$1_11.body.SetAwake(true);if(!this.$1_10){this.$1_0.setRange(48,120,true);this.$1_C=0.3;}}else{if(this.$1_10){this.$1_0.setRange(0,47,true);this.$1_C=-0.2;}this.$1_11.body.SetAwake(false);}this.$1_1.translate3(-(this.$1_1.localTranslation.elements[0]-this.$1_11.body.m_xf.position.x),-(this.$1_1.localTranslation.elements[1]-0.5),-(this.$1_1.localTranslation.elements[2]-this.$1_11.body.m_xf.position.y));this.$1_10=this.$1_F;}}
GLSharp.Demo.registerClass('GLSharp.Demo',GLSharp.Game.GameBase);GLSharp.DemoGame.Controllers.CameraController.registerClass('GLSharp.DemoGame.Controllers.CameraController',GLSharp.Universe.ControllerBase);GLSharp.DemoGame.Controllers.MechControllerBase.registerClass('GLSharp.DemoGame.Controllers.MechControllerBase',GLSharp.Universe.ControllerBase);GLSharp.DemoGame.Controllers.PlayerController.registerClass('GLSharp.DemoGame.Controllers.PlayerController',GLSharp.DemoGame.Controllers.MechControllerBase);})();// This script was generated using Script# v0.7.4.0
